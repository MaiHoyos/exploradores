<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi√≥n 3: Corredor de Cr√°teres del Sensorium</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Exo 2', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .sheet-title {
            font-family: 'Orbitron', sans-serif;
        }

        textarea {
            resize: vertical;
        }

        .sheet-label {
            @apply text-sm text-purple-200 uppercase tracking-wide mb-1;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-black text-white relative overflow-auto">
    <div class="stars" id="stars"></div>
    
    <!-- HEADER -->
    <header class="relative z-10 bg-gradient-to-r from-purple-400 to-purple-600 border-4 border-white rounded-b-3xl p-6 m-4">
        <div class="flex items-center justify-between gap-4">
            <button onclick="volverAMisiones()" class="px-4 py-2 bg-white text-purple-600 font-bold rounded-full shadow-lg transition-transform transform hover:scale-105">
                ‚Üê Volver a Misiones
            </button>
            <div class="flex items-center gap-3">
                <div class="text-3xl font-extrabold text-white drop-shadow-lg">MISI√ìN 3</div>
                <div class="text-4xl">üååü§ù</div>
            </div>
            <div id="completion-badge" class="hidden px-4 py-2 bg-green-500 text-white font-bold rounded-full shadow-lg">
                ‚úÖ Completada
            </div>
        </div>
    </header>

    <main class="relative z-10 p-6 md:p-10 max-w-5xl mx-auto space-y-8">

        <!-- HOJA 1: HISTORIA Y OBJETIVO -->
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-white/30 shadow-2xl space-y-4">
            <h2 class="sheet-title text-2xl md:text-3xl font-bold text-center mb-2 text-yellow-300">
                Hoja 1 ¬∑ Corredor de Cr√°teres del Sensorium
            </h2>
            <p class="text-lg text-white/90 text-center">
                En el planeta <span class="font-bold text-teal-300">Sensorium</span>, dos RoverBots deben colaborar para transportar una valiosa muestra de energ√≠a
                hasta un punto exacto del mapa. El camino est√° lleno de cr√°teres y zonas inestables. 
                Solo lo lograr√°n si planifican <span class="font-semibold text-yellow-300">trayectorias con giros y √°ngulos precisos</span>, 
                mantienen la misma velocidad y se comunican como un verdadero equipo cient√≠fico.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center mt-4">
                <div>
                    <img src="mision3_sensorium.png"
                         alt="Corredor de cr√°teres en Sensorium"
                         class="w-full rounded-2xl border-4 border-white/60 shadow-xl"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full aspect-video flex items-center justify-center text-4xl md:text-6xl bg-gradient-to-br from-purple-500 via-blue-500 to-black rounded-2xl border-4 border-white/40&quot;>üååüï≥Ô∏èüï≥Ô∏è</div>'">
                </div>

                <div class="bg-black/40 p-4 md:p-5 rounded-2xl border-2 border-white/40 space-y-2">
                    <h3 class="text-xl md:text-2xl font-semibold text-white mb-2">Objetivo de la misi√≥n</h3>
                    <ul class="list-disc list-inside text-white/90 space-y-1">
                        <li>Unir dos RoverBots para transportar una misma carga.</li>
                        <li>Dise√±ar un recorrido con <span class="font-semibold">cambios de direcci√≥n y √°ngulos</span>.</li>
                        <li>Evitar cr√°teres usando mediciones de distancia y coordinaci√≥n.</li>
                        <li>Detenerse exactamente en el punto de entrega marcado.</li>
                    </ul>
                </div>
            </div>

            <div class="mt-6 space-y-2">
                <p class="font-semibold text-purple-300">Conceptos matem√°ticos en juego:</p>
                <ul class="list-disc list-inside text-white/90 space-y-1">
                    <li>Medici√≥n de distancias en cent√≠metros o unidades del tablero.</li>
                    <li>√Ångulos rectos (90¬∞), giros de 45¬∞, 135¬∞ o 180¬∞ para cambiar de direcci√≥n.</li>
                    <li>Relaci√≥n entre potencia, tiempo y distancia (proporcionalidad).</li>
                    <li>Representaci√≥n del recorrido como camino en un plano cuadriculado.</li>
                </ul>
            </div>
        </section>

        <!-- HOJA 2: DISE√ëA LA RUTA (ESPACIOS PARA ESCRIBIR) -->
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-indigo-300/40 shadow-2xl space-y-4">
            <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center mb-2">
                Hoja 2 ¬∑ Dise√±a tu trayectoria segura
            </h2>
            <p class="text-white/90">
                Marca en el suelo (o en una hoja cuadriculada) el punto de inicio <span class="font-semibold text-teal-300">A</span>,
                el punto de entrega <span class="font-semibold text-teal-300">B</span> y al menos 
                <span class="font-semibold text-yellow-300">2 cr√°teres</span> que debes esquivar.
                La ruta debe tener al menos <span class="font-semibold">dos giros</span>.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                <div class="space-y-2">
                    <label class="block text-sm text-purple-200">Describe tu ruta (ejemplo: 40 cm recto, giro 90¬∞, 30 cm recto, giro 90¬∞, 20 cm recto):</label>
                    <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white"
                              rows="4"
                              placeholder="Escribe aqu√≠ la secuencia de movimientos con medidas y √°ngulos..."></textarea>
                </div>
                <div class="space-y-2">
                    <label class="block text-sm text-purple-200">Dibuja o describe d√≥nde est√°n los cr√°teres:</label>
                    <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white"
                              rows="4"
                              placeholder="Ejemplo: Cr√°ter 1 a la derecha del inicio, Cr√°ter 2 cerca del punto medio, etc."></textarea>
                </div>
            </div>

            <div class="mt-4 space-y-2">
                <label class="block text-sm text-purple-200">Predicci√≥n matem√°tica:</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white"
                          rows="3"
                          placeholder="¬øQu√© potencia (%) y tiempo (s) crees que deben usar los RoverBots para llegar juntos al punto B sin caer en los cr√°teres? Explica."></textarea>
            </div>
        </section>

        <!-- HOJA 3: CONSTRUCCI√ìN - UNIR LOS ROBOTS (IM√ÅGENES COLABORACI√ìN) -->
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-pink-300/40 shadow-2xl space-y-4">
            <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center mb-2">
                Hoja 3 ¬∑ Construye el m√≥dulo de colaboraci√≥n
            </h2>
            <p class="text-white/90 text-center">
                Ahora deben <span class="font-semibold text-teal-300">conectar f√≠sicamente</span> los dos RoverBots para transportar la misma carga.
                Sigan los pasos visuales y aseg√∫rense de que la estructura sea estable.
            </p>

            <!-- Paso 1 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 1: Base de conexi√≥n</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/1.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 1"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/2.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 2"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/3.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 3"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <!-- Paso 2 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 2: Refuerza la uni√≥n</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/4.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 4"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/5.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 5"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/6.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 6"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <!-- Paso 3 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 3: Ajusta el soporte de la carga</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/7.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 7"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/8.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 8"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/9.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 9"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <!-- Paso 4 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 4: Conecta ambos RoverBots</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/10.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 10"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/11.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 11"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/12.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 12"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <!-- Paso 5 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 5: Verifica estabilidad</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/13.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 13"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/14.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 14"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/15.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 15"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <!-- Paso 6 -->
            <div class="mt-4">
                <h3 class="text-lg font-semibold text-white mb-2">Paso 6: Detalles finales</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/16.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 16"
                         onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/17.jpg" class="w-full rounded-2xl border-2 border-white/40" alt="Paso 17"
                         onerror="this.style.display='none';">
                </div>
            </div>

            <p class="mt-4 text-xs text-white/70">
                Imagen ¬©2015 The LEGO Group. Usada con fines educativos y sin √°nimo de lucro.
                Fuente: Instrucciones de construcci√≥n del set LEGO¬Æ Education WeDo 2.0 (45300).
            </p>

            <div class="mt-4 space-y-2">
                <label class="block text-sm text-purple-200">Anota aqu√≠ mejoras o ajustes que tu equipo hizo al dise√±o:</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white"
                          rows="3"
                          placeholder="¬øTuvieron que reforzar algo? ¬øMover la carga?"></textarea>
            </div>
        </section>

        <!-- HOJA 4: PROGRAMACI√ìN, DATOS Y √ÅNGULOS -->
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-cyan-300/40 shadow-2xl space-y-4">
            <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center mb-2">
                Hoja 4 ¬∑ Programa, prueba y calcula
            </h2>
            <p class="text-white/90">
                Programen ambos RoverBots para que sigan la ruta dise√±ada (con giros y cambios de direcci√≥n)
                y lleguen juntos al punto de entrega. Hagan al menos <span class="font-semibold">3 ensayos</span>, ajustando cuando sea necesario.
            </p>

            <div class="overflow-x-auto mt-4">
                <table class="min-w-full text-sm text-center border border-white/30 rounded-2xl overflow-hidden">
                    <thead class="bg-black/60 text-purple-200">
                        <tr>
                            <th class="px-2 py-2 border border-white/20">Ensayo</th>
                            <th class="px-2 py-2 border border-white/20">Distancia total (cm)</th>
                            <th class="px-2 py-2 border border-white/20">Potencia Rover A (%)</th>
                            <th class="px-2 py-2 border border-white/20">Potencia Rover B (%)</th>
                            <th class="px-2 py-2 border border-white/20">Tiempo (s)</th>
                            <th class="px-2 py-2 border border-white/20">√Ångulos usados</th>
                            <th class="px-2 py-2 border border-white/20">¬øLlegan juntos?</th>
                        </tr>
                    </thead>
                    <tbody class="bg-black/40 text-white/90">
                        <tr>
                            <td class="px-2 py-2 border border-white/10">1</td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                        </tr>
                        <tr>
                            <td class="px-2 py-2 border border-white/10">2</td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                        </tr>
                        <tr>
                            <td class="px-2 py-2 border border-white/10">3</td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                            <td class="px-2 py-2 border border-white/10"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="mt-4 space-y-2">
                <label class="block text-sm text-purple-200">Explica un ajuste matem√°tico que ayud√≥ a mejorar el recorrido:</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white"
                          rows="3"
                          placeholder="Por ejemplo: cambiamos la potencia de 70% a 60% para que ambos llegaran al mismo tiempo."></textarea>
            </div>
        </section>

        <!-- HOJA 5: REFLEXI√ìN Y EVIDENCIAS -->
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-green-300/40 shadow-2xl space-y-4">
            <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center mb-2">
                Hoja 5 ¬∑ Reflexiona y comparte tus evidencias
            </h2>
            <p class="text-white/90 text-center">
                Completa esta hoja como equipo. Aqu√≠ demuestran lo que aprendieron en la misi√≥n de colaboraci√≥n en Sensorium.
            </p>

            <div class="space-y-3 mt-4">
                <label class="block text-sm text-purple-200">1. ¬øPor qu√© fue importante coordinar a los dos RoverBots?</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white" rows="3"></textarea>

                <label class="block text-sm text-purple-200">2. ¬øC√≥mo usaron las matem√°ticas (distancias, tiempos, √°ngulos) para tomar decisiones?</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white" rows="3"></textarea>

                <label class="block text-sm text-purple-200">3. Describe un ejemplo concreto de buena colaboraci√≥n en tu equipo.</label>
                <textarea class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white" rows="3"></textarea>
            </div>

            <div class="mt-4 space-y-2">
                <p class="text-sm text-purple-200">
                    Sube al Drive del curso tus evidencias (fotos, videos, capturas de pantalla de la programaci√≥n) 
                    y pega aqu√≠ el enlace:
                </p>
                <input type="text"
                       class="w-full p-3 rounded-2xl bg-black/60 border border-white/30 text-white text-sm"
                       placeholder="Pega aqu√≠ el enlace a tu carpeta de evidencias en Drive">
            </div>

            <div class="mt-6 flex justify-center gap-4">
                <button id="complete-btn"
                        onclick="completeMission()"
                        class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                    Marcar Misi√≥n 3 como completada
                </button>
                <a href="index.html"
                   id="completed-btn"
                   class="hidden px-6 py-3 bg-white text-green-600 font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                    Volver a Misiones
                </a>
            </div>
        </section>
    </main>

    <script>
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Progreso en localStorage
        function getCurrentPlayer() {
            return localStorage.getItem('zython-current-player');
        }

        function loadPlayerProgress(playerName) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                return players[playerName] || {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            } catch (error) {
                console.error('Error loading progress:', error);
                return {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            }
        }

        function savePlayerProgress(playerName, progress) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                players[playerName] = progress;
                localStorage.setItem('zython-players', JSON.stringify(players));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function checkCompletion() {
            const currentPlayer = getCurrentPlayer();
            if (currentPlayer) {
                const progress = loadPlayerProgress(currentPlayer);
                if (progress.completedMissions.includes(3)) {
                    document.getElementById('completion-badge').classList.remove('hidden');
                    const completeBtn = document.getElementById('complete-btn');
                    const completedBtn = document.getElementById('completed-btn');
                    if (completeBtn) completeBtn.classList.add('hidden');
                    if (completedBtn) completedBtn.classList.remove('hidden');
                }
            }
        }

        function completeMission() {
            const currentPlayer = getCurrentPlayer();
            if (!currentPlayer) {
                console.error('No current player for mission completion');
                alert('Error: No se encontr√≥ informaci√≥n del jugador. Por favor, regresa al men√∫ principal.');
                return;
            }

            const progress = loadPlayerProgress(currentPlayer);

            if (!progress.completedMissions.includes(3)) {
                progress.completedMissions.push(3);
                progress.completed = progress.completedMissions.length;
                progress.badges = progress.completedMissions.length;

                // Desbloquear misi√≥n 4
                progress.currentMission = Math.max(progress.currentMission, 4);
                progress.available = Math.max(progress.available, 4);

                savePlayerProgress(currentPlayer, progress);

                document.getElementById('completion-badge').classList.remove('hidden');
                const completeBtn = document.getElementById('complete-btn');
                const completedBtn = document.getElementById('completed-btn');
                if (completeBtn) completeBtn.classList.add('hidden');
                if (completedBtn) completedBtn.classList.remove('hidden');

                alert('¬°Felicitaciones! Has completado la Misi√≥n 3 en Sensorium. La Misi√≥n 4 ahora est√° disponible.');
            } else {
                alert('Esta misi√≥n ya ha sido completada anteriormente.');
            }
        }

        function volverAMisiones() {
            window.location.href = 'index.html';
        }

        function initialize() {
            createStars();
            checkCompletion();
        }

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
