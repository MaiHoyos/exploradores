<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi√≥n 3: El Enigma de Zython</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Fredoka', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .title-font {
            font-family: 'Fredoka', system-ui, sans-serif;
            letter-spacing: 0.05em;
        }

        /* Fondo animado con gradiente din√°mico */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(-45deg, #1e3a8a, #312e81, #1e1b4b, #0f172a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -2;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Estrellas mejoradas con brillo */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
            box-shadow: 0 0 4px rgba(255, 255, 255, 0.8);
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Estrella fugaz ocasional */
        @keyframes shootingStar {
            0% { transform: translateX(0) translateY(0); opacity: 1; }
            100% { transform: translateX(-300px) translateY(300px); opacity: 0; }
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
            animation: shootingStar 1.5s ease-out;
        }

        /* Transici√≥n suave entre hojas */
        .page {
            display: none;
            animation: fadeInScale 0.5s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Botones 3D mejorados */
        .sheet-nav-btn {
            @apply px-4 py-2 md:px-6 md:py-3 bg-gradient-to-br from-cyan-500 to-blue-600 text-white rounded-full text-xs md:text-sm font-bold tracking-wide shadow-lg;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }

        .sheet-nav-btn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.4);
        }

        .sheet-nav-btn:active:not(:disabled) {
            transform: translateY(0) scale(0.98);
        }

        .sheet-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Answer box con efecto vidrio */
        .answer-box {
            border: 2px solid rgba(96, 165, 250, 0.5);
            border-radius: 1rem;
            padding: 0.75rem;
            min-height: 4rem;
            margin-top: 0.35rem;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .answer-box:hover {
            border-color: rgba(96, 165, 250, 0.8);
            background: rgba(15, 23, 42, 0.8);
        }

        /* Image slot mejorado */
        .image-slot {
            border: 2px dashed rgba(248, 250, 252, 0.65);
            border-radius: 1.5rem;
            padding: 1rem;
            min-height: 6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: rgba(226, 232, 240, 0.85);
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .image-slot:hover {
            border-color: rgba(248, 250, 252, 0.9);
            background: rgba(15, 23, 42, 0.8);
        }

        /* Label chip con pulso */
        .label-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.15rem 0.6rem;
            border-radius: 999px;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 253, 0.6);
            color: #bfdbfe;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Efecto hover en im√°genes */
        .hover-lift {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .hover-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        /* Badge pulsante */
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .badge-pulse {
            animation: badgePulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="min-h-screen text-white relative overflow-auto">
    <div class="stars" id="stars"></div>

    <!-- HEADER -->
    <header class="relative z-10 bg-gradient-to-r from-indigo-500 via-cyan-400 to-emerald-400 border-4 border-white/90 rounded-b-3xl p-4 md:p-6 m-3 md:m-4 shadow-2xl">
        <div class="flex items-center justify-between gap-3 md:gap-6">
            <button onclick="volverAMisiones()" class="px-3 md:px-4 py-2 bg-black/80 text-cyan-300 font-bold rounded-full shadow-lg text-xs md:text-sm transition-transform transform hover:scale-105 hover:shadow-xl border border-cyan-300/70">
                ‚Üê Volver a Misiones
            </button>
            <div class="flex flex-col items-center justify-center text-center flex-1">
                <div class="title-font text-xs md:text-sm text-slate-900 font-semibold tracking-[0.22em] uppercase">Exploraci√≥n de Zython</div>
                <div class="flex items-center gap-2 md:gap-4 mt-1">
                    <div class="text-2xl md:text-4xl">üõ∞Ô∏è</div>
                    <div class="title-font text-xl md:text-3xl lg:text-4xl font-extrabold text-white drop-shadow-lg">
                        MISI√ìN 3 ¬∑ EL ENIGMA DE ZYTHON
                    </div>
                    <div class="text-2xl md:text-4xl">üèõÔ∏è</div>
                </div>
                <div class="mt-1 text-[0.6rem] md:text-xs text-slate-900/90 font-semibold bg-white/70 px-3 py-1 rounded-full inline-flex items-center gap-2 badge-pulse">
                    <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    Reto final ¬∑ Civilizaci√≥n perdida ¬∑ Aplicaci√≥n de todo lo aprendido
                </div>
            </div>
            <div id="completion-badge" class="hidden px-2 md:px-4 py-2 bg-emerald-500 text-white font-bold rounded-full shadow-lg text-[0.6rem] md:text-xs">
                ‚úÖ Misi√≥n completada
            </div>
        </div>
    </header>

    <!-- MAIN -->
    <main class="relative z-10 p-3 md:p-6 max-w-5xl mx-auto pb-16">
        <!-- NAV ENTRE HOJAS -->
        <div class="flex items-center justify-between mb-3 md:mb-4">
            <button id="prev-page-btn" class="sheet-nav-btn" onclick="changePage(-1)">‚Üê Hoja anterior</button>
            <div class="flex items-center gap-2">
                <span class="label-chip">
                    <span>Misiones completadas impactan tu leyenda</span>
                </span>
                <span id="page-indicator" class="text-[0.6rem] md:text-xs text-cyan-200/80 font-semibold">
                    Hoja 1 de 6
                </span>
            </div>
            <button id="next-page-btn" class="sheet-nav-btn" onclick="changePage(1)">Siguiente hoja ‚Üí</button>
        </div>

        <!-- HOJA 1: INTRO CINEM√ÅTICA -->
        <section class="page active bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-indigo-300/50 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl lg:text-4xl font-extrabold text-center mb-4 md:mb-6 text-cyan-300 drop-shadow-lg">
                Se√±al en la Oscuridad: La Ciudad Perdida de Zython
            </h2>
            <p class="text-base md:text-lg text-slate-50/95 text-center mb-4 leading-relaxed">
                Tras completar todas las pruebas, los sensores de la base detectan <span class="text-cyan-300 font-semibold">un patr√≥n de energ√≠a desconocido</span> en el hemisferio sur de Zython.
                Las lecturas muestran formas geom√©tricas perfectas y caminos que no pueden ser obra del azar.
            </p>
            <p class="text-base md:text-lg text-slate-100/90 text-center mb-4 leading-relaxed">
                Tu misi√≥n legendaria: <span class="font-semibold text-emerald-300">dise√±ar, calibrar y programar un RoverBot aut√≥nomo</span> capaz de viajar desde la Base Central
                hasta el coraz√≥n de una posible <span class="text-yellow-300 font-semibold">civilizaci√≥n antigua zythoniana</span>, navegando por calles, giros y obst√°culos con precisi√≥n matem√°tica.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mt-4 items-center">
                <div class="w-full rounded-2xl border-4 border-white/50 shadow-xl overflow-hidden hover-lift">
                    <img src="Zython/1.webp" alt="Ciudad Perdida de Zython" 
                         class="w-full h-auto object-cover rounded-2xl"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;image-slot&quot;>Imagen no encontrada</div>'">
                </div>

                <div class="bg-black/40 backdrop-blur-md p-4 md:p-5 rounded-2xl border border-cyan-300/50 shadow-xl hover-lift">
                    <h3 class="text-lg md:text-2xl font-semibold mb-2 text-cyan-300">Objetivo √©pico de la misi√≥n</h3>
                    <ul class="list-disc list-inside space-y-1 text-sm md:text-base text-slate-100/95">
                        <li>Aplicar todo lo aprendido sobre <span class="font-semibold text-emerald-300">movimiento, giros, sensores y rutas seguras</span>.</li>
                        <li>Usar <span class="font-semibold text-yellow-300">medidas, √°ngulos, datos y proporciones</span> para tomar decisiones reales.</li>
                        <li>Demostrar trabajo en equipo como aut√©nticos <span class="font-semibold text-cyan-300">Exploradores Maestros de Zython</span>.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- HOJA 2: OBJETIVOS + MATERIALES -->
        <section class="page bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-cyan-300/50 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl font-extrabold text-cyan-300 mb-4 text-center">
                ¬øQu√© vas a demostrar en este reto final?
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="bg-black/30 backdrop-blur-md p-4 rounded-2xl border border-emerald-300/50 hover-lift">
                    <h3 class="text-lg md:text-xl font-semibold text-emerald-300 mb-2">Objetivos de aprendizaje</h3>
                    <ul class="list-disc list-inside text-sm md:text-base space-y-1 text-slate-100/95">
                        <li>Dise√±ar y construir un RoverBot capaz de avanzar y girar con autonom√≠a.</li>
                        <li>Relacionar <span class="font-semibold">potencia, tiempo y √°ngulo</span> para describir movimientos.</li>
                        <li>Crear trayectorias usando <span class="font-semibold">√°ngulos y distancias</span> en un mapa urbano.</li>
                        <li>Registrar y analizar datos de ensayos para mejorar la precisi√≥n.</li>
                        <li>Subir la evidencia de tu trabajo a un repositorio compartido (Drive).</li>
                    </ul>
                </div>
                <div class="bg-black/30 backdrop-blur-md p-4 rounded-2xl border border-yellow-300/50 hover-lift">
                    <h3 class="text-lg md:text-xl font-semibold text-yellow-300 mb-2">Materiales</h3>
                    <ul class="list-disc list-inside text-sm md:text-base space-y-1 text-slate-100/95">
                        <li>Kit <span class="font-semibold">LEGO¬Æ Education WeDo 2.0 o similares</span> (1‚Äì2 motores, sensor).</li>
                        <li>Cinta m√©trica, cron√≥metro, cinta adhesiva.</li>
                        <li>Cart√≥n, cartulina o base para la maqueta urbana.</li>
                        <li>Regla, transportador, l√°pices, marcadores.</li>
                        <li>Computador con <span class="font-semibold">Scratch u otro entorno compatible</span>.</li>
                        <li>Cuenta para subir archivos a <span class="font-semibold">Drive</span>.</li>
                    </ul>
                    <p class="mt-3 text-[0.7rem] md:text-xs text-slate-300/90 leading-snug">
                        Im√°genes de construcci√≥n:
                        <span class="italic">
                            "Imagen ¬©2015 The LEGO Group. Usada con fines educativos y sin √°nimo de lucro.
                            Fuente: Instrucciones de construcci√≥n del set LEGO¬Æ Education WeDo 2.0 (45300) o similares."
                        </span>
                    </p>
                </div>
            </div>
        </section>

        <!-- HOJA 3: ETAPA 1 - DISE√ëO ROBOT + ESPACIOS -->
        <section class="page bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-indigo-300/40 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl font-extrabold text-emerald-300 mb-3 text-center">
                Etapa 1 ¬∑ Dise√±a tu RoverBot Navegador
            </h2>
            <p class="text-sm md:text-base text-slate-100/95 mb-3 text-center leading-relaxed">
                Crea un RoverBot estable que pueda <span class="font-semibold text-cyan-300">avanzar recto, girar y reaccionar</span> con uno o dos motores
                y, si lo decides, con sensor para detenerse o cambiar de direcci√≥n.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mt-3">
                <div class="image-slot">
                    ESPACIO PARA DIBUJO / FOTO DEL ROVERBOT NAVEGADOR
                </div>
                <div>
                    <h3 class="text-sm md:text-base font-semibold text-yellow-300 mb-1">
                        1. Describe el dise√±o de tu RoverBot:
                    </h3>
                    <div class="answer-box">
                        Escribe aqu√≠ c√≥mo est√° construido tu RoverBot, qu√© motores usa, d√≥nde va el sensor, c√≥mo girar√°...
                    </div>

                    <h3 class="text-sm md:text-base font-semibold text-yellow-300 mt-3 mb-1">
                        2. ¬øQu√© decisiones tomaste para que sea estable?
                    </h3>
                    <div class="answer-box">
                        Explica qu√© cambios hiciste para que no se voltee, se deslice bien y pueda recorrer la ciudad con seguridad.
                    </div>
                </div>
            </div>
        </section>

        <!-- HOJA 4: ETAPA 2 - CALIBRACI√ìN + TABLA (INSTRUCCI√ìN EXCEL/WORD) -->
        <section class="page bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-cyan-400/40 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl font-extrabold text-cyan-300 mb-3 text-center">
                Etapa 2 ¬∑ Calibra tus Giros: Tiempo ‚Üí √Ångulo
            </h2>
            <p class="text-sm md:text-base text-slate-100/95 mb-3 leading-relaxed">
                Ahora debes descubrir c√≥mo se transforman los valores del programa en giros reales.
                Dibuja en el suelo un gran semic√≠rculo graduado o usa un transportador grande.
            </p>
            <ol class="list-decimal list-inside text-sm md:text-base space-y-1 text-slate-100/95 mb-3">
                <li>Programa tu RoverBot para girar usando distintas combinaciones de potencia y tiempo.</li>
                <li>Observa el √°ngulo real que gira.</li>
                <li>Registra los datos en una tabla digital.</li>
            </ol>

            <div class="bg-black/50 backdrop-blur-md rounded-2xl border border-indigo-300/50 p-3 md:p-4 mb-3 hover-lift">
                <p class="text-xs md:text-sm text-cyan-200/95 font-semibold mb-1">
                    Tarea digital obligatoria:
                </p>
                <p class="text-[0.7rem] md:text-xs text-slate-100/90 leading-relaxed">
                    Crea una tabla en <span class="font-semibold">Excel o Word</span> con las columnas:
                    <span class="font-semibold">Potencia (%) ¬∑ Tiempo (s) ¬∑ √Ångulo aproximado (¬∞)</span>.
                    Guarda el archivo con el nombre <span class="font-semibold">"M3_Apellido_Grupo_Calibraci√≥nGiros"</span>
                    y s√∫belo a la carpeta de <span class="font-semibold">Drive</span> indicada por tu docente.
                </p>
            </div>

            <div class="image-slot mb-3">
                ESPACIO PARA CAPTURA / ESQUEMA DE TABLA DE GIROS
            </div>

            <h3 class="text-xs md:text-sm font-semibold text-yellow-300 mb-1">
                Escribe aqu√≠ tus primeras conclusiones (resumen breve):
            </h3>
            <div class="answer-box">
                ¬øQu√© patrones observas entre tiempo, potencia y √°ngulo? ¬øAlguna combinaci√≥n que funcione bien para 90¬∞, 180¬∞...?
            </div>
        </section>

        <!-- HOJA 5: ETAPA 3 - MAQUETA CIUDAD + PLAN RUTA -->
        <section class="page bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-indigo-400/40 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl font-extrabold text-emerald-300 mb-3 text-center">
                Etapa 3 ¬∑ La Ciudad Perdida de Zython
            </h2>
            <p class="text-sm md:text-base text-slate-100/95 mb-2 leading-relaxed">
                Construyan una maqueta que represente una zona de la posible ciudad zythoniana:
                calles, giros, pasillos, plazas, obst√°culos y el <span class="text-yellow-300 font-semibold">Templo de los Antiguos</span>.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mt-2">
                <div class="image-slot">
                    ESPACIO PARA FOTO / DIBUJO DE LA MAQUETA URBANA
                </div>
                <div>
                    <h3 class="text-xs md:text-sm font-semibold text-cyan-300 mb-1">
                        1. Marca el punto de inicio (Base) y el punto final (Templo de los Antiguos).
                    </h3>
                    <div class="answer-box">
                        Describe aqu√≠ d√≥nde est√° la Base, d√≥nde est√° el Templo y qu√© obst√°culos hay en el camino.
                    </div>

                    <h3 class="text-xs md:text-sm font-semibold text-cyan-300 mt-3 mb-1">
                        2. Dise√±a tu ruta:
                    </h3>
                    <div class="answer-box">
                        Escribe la secuencia de movimientos usando distancias y √°ngulos (ejemplo:
                        40 cm recto ‚Üí giro 90¬∞ derecha ‚Üí 30 cm recto ‚Üí giro 45¬∞ izquierda...).
                    </div>
                </div>
            </div>

            <p class="mt-3 text-[0.7rem] md:text-xs text-slate-200/90">
                Si lo prefieres, dibuja la ruta en un documento Word, marca los giros y s√∫belo junto con la foto de la maqueta al Drive.
            </p>
        </section>

        <!-- HOJA 6: ETAPA 4 - PROGRAMA, REFLEXI√ìN + COMPLETAR MISI√ìN -->
        <section class="page bg-white/10 backdrop-blur-md rounded-3xl p-5 md:p-8 border-4 border-emerald-400/40 shadow-2xl">
            <h2 class="title-font text-2xl md:text-3xl font-extrabold text-yellow-300 mb-3 text-center">
                Etapa 4 ¬∑ Ejecuta la Misi√≥n y Descubre el Enigma
            </h2>
            <ol class="list-decimal list-inside text-sm md:text-base space-y-1 text-slate-100/95 mb-3">
                <li>Programa tu RoverBot con la secuencia completa de movimientos para ir desde la Base hasta el Templo.</li>
                <li>Prueba el recorrido sin tocar el robot. Si falla, ajusta tus valores.</li>
                <li>Cuenta cu√°ntos intentos necesitaste y qu√© cambios hiciste.</li>
            </ol>

            <h3 class="text-xs md:text-sm font-semibold text-cyan-300 mb-1">
                1. Registra tus resultados:
            </h3>
            <div class="answer-box">
                N√∫mero de intentos, tiempo total, si lleg√≥ al punto correcto, qu√© tuviste que corregir en tu programa.
            </div>

            <h3 class="text-xs md:text-sm font-semibold text-cyan-300 mt-3 mb-1">
                2. En tu documento digital (Word o Excel), a√±ade:
            </h3>
            <ul class="list-disc list-inside text-[0.7rem] md:text-xs text-slate-100/90 mb-3">
                <li>Foto del RoverBot y de la maqueta.</li>
                <li>Tabla de calibraci√≥n de giros.</li>
                <li>Ruta escrita o dibujada.</li>
                <li>Breve explicaci√≥n: ¬øc√≥mo te ayud√≥ la matem√°tica a lograr la misi√≥n?</li>
                <li>Sube el archivo final a la carpeta de <span class="font-semibold">Drive</span> indicada.</li>
            </ul>

            <div class="bg-black/60 backdrop-blur-md rounded-2xl border border-yellow-300/70 p-4 mt-2 hover-lift">
                <p class="text-sm md:text-base text-yellow-300 font-semibold mb-1">
                    Mensaje de la Civilizaci√≥n de Zython:
                </p>
                <p class="text-xs md:text-sm text-slate-100/95 leading-relaxed">
                    "La precisi√≥n es la huella de quienes piensan antes de avanzar.
                    Has unido construcci√≥n, programaci√≥n y matem√°ticas para descifrar nuestro legado.
                    Desde hoy, eres un <span class="font-semibold text-emerald-300">Maestro Explorador de Zython</span>."
                </p>
            </div>

            <!-- BOTONES DE COMPLETAR MISI√ìN -->
            <div class="mt-6 flex flex-col md:flex-row justify-center items-center gap-3">
                <button id="complete-btn"
                        onclick="completeMission()"
                        class="px-6 md:px-8 py-3 bg-gradient-to-r from-emerald-400 via-cyan-400 to-indigo-500 text-black font-extrabold text-base md:text-lg rounded-full shadow-xl transition-transform transform hover:scale-110 hover:shadow-2xl">
                    üèÅ He completado el Enigma de Zython
                </button>
                <a href="index.html"
                   id="completed-btn"
                   class="hidden px-6 md:px-8 py-3 bg-white text-emerald-700 font-extrabold text-base md:text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl text-center">
                    üèÜ ¬°Todas las Misiones Completadas!
                </a>
            </div>

            <section id="final-celebration" class="hidden mt-6 text-center">
                <h2 class="title-font text-3xl md:text-4xl font-extrabold text-emerald-300 drop-shadow-xl">
                    ¬°Felicitaciones, Maestro Explorador!
                </h2>
                <p class="text-sm md:text-base text-slate-100/95 mt-2 leading-relaxed">
                    Has completado el viaje por Zython. Tu RoverBot no solo se mueve: <span class="font-semibold text-cyan-300">piensa con matem√°ticas</span>.
                </p>
            </section>
        </section>
    </main>

    <script>
        /* Fondo estrellas mejorado con m√°s estrellas y brillo */
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 2.5 + 0.8;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.opacity = Math.random() * 0.8 + 0.2;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        /* Estrellas fugaces ocasionales */
        function createShootingStar() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            
            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.left = Math.random() * 100 + '%';
            shootingStar.style.top = Math.random() * 50 + '%';
            starsContainer.appendChild(shootingStar);
            
            setTimeout(() => {
                shootingStar.remove();
            }, 1500);
        }

        setInterval(createShootingStar, 5000);


        /* Corregido el n√∫mero de misi√≥n de 4 a 3 */
        function completeMission() {
            const currentPlayer = getCurrentPlayer();
            if (!currentPlayer) {
                alert('Error: No se encontr√≥ informaci√≥n del jugador. Regresa al men√∫ principal e ingresa tu nombre de explorador.');
                return;
            }

            const progress = loadPlayerProgress(currentPlayer);

            if (!progress.completedMissions.includes(3)) {
                progress.completedMissions.push(3);
                progress.completed = progress.completedMissions.length;
                progress.badges = progress.completedMissions.length;
                progress.currentMission = 3;

                savePlayerProgress(currentPlayer, progress);

                document.getElementById('completion-badge').classList.remove('hidden');
                document.getElementById('complete-btn').classList.add('hidden');
                document.getElementById('completed-btn').classList.remove('hidden');

                const celebration = document.getElementById('final-celebration');
                if (celebration) celebration.classList.remove('hidden');

                alert('üéâ ¬°FELICITACIONES! üéâ\n\nHas resuelto el Enigma de Zython y completado todas las misiones.\nEres oficialmente un Maestro Explorador Espacial.\n\nTu RoverBot ahora aplica la matem√°tica para explorar nuevos mundos.');
            } else {
                alert('Esta misi√≥n ya fue completada. ¬°Ya eres Maestro Explorador de Zython!');
            }
        }

        function volverAMisiones() {
            window.location.href = 'index.html';
        }

        function getCurrentPlayer() {
            return localStorage.getItem('zython-current-player');
        }

        function loadPlayerProgress(playerName) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                return players[playerName] || {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            } catch (error) {
                console.error('Error loading progress:', error);
                return {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            }
        }

        function savePlayerProgress(playerName, progress) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                players[playerName] = progress;
                localStorage.setItem('zython-players', JSON.stringify(players));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function checkCompletion() {
            const currentPlayer = getCurrentPlayer();
            if (currentPlayer) {
                const progress = loadPlayerProgress(currentPlayer);
                if (progress.completedMissions.includes(3)) {
                    document.getElementById('completion-badge').classList.remove('hidden');
                    document.getElementById('complete-btn').classList.add('hidden');
                    document.getElementById('completed-btn').classList.remove('hidden');
                    const celebration = document.getElementById('final-celebration');
                    if (celebration) celebration.classList.remove('hidden');
                }
            }
        }

        /* NAVEGACI√ìN ENTRE HOJAS */
        let currentPage = 0;

        function showPage(index) {
            const pages = document.querySelectorAll('.page');
            if (pages.length === 0) return;

            if (index < 0) index = 0;
            if (index >= pages.length) index = pages.length - 1;

            pages.forEach((page, i) => {
                page.classList.toggle('active', i === index);
            });

            currentPage = index;

            const prevBtn = document.getElementById('prev-page-btn');
            const nextBtn = document.getElementById('next-page-btn');
            if (prevBtn) prevBtn.disabled = currentPage === 0;
            if (nextBtn) nextBtn.disabled = currentPage === pages.length - 1;

            const indicator = document.getElementById('page-indicator');
            if (indicator) {
                indicator.textContent = `Hoja ${currentPage + 1} de ${pages.length}`;
            }
        }

        function changePage(step) {
            showPage(currentPage + step);
        }

        /* INIT */
        function initialize() {
            createStars();
            showPage(0);
            checkCompletion();
        }

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
