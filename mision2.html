<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi√≥n 2: Milo en Zycurva ‚Äì Evita el Abismo</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-black text-white relative overflow-auto">
    <div class="stars" id="stars"></div>
    
    <header class="relative z-10 bg-gradient-to-r from-blue-400 to-blue-600 border-4 border-white rounded-b-3xl p-6 m-4">
        <div class="flex items-center justify-between">
            <button onclick="volverAMisiones()" class="px-4 py-2 bg-white text-blue-600 font-bold rounded-full shadow-lg transition-transform transform hover:scale-105">
                ‚Üê Volver a Misiones
            </button>
            <div class="flex items-center space-x-4">
                <div class="text-3xl font-extrabold text-white drop-shadow-lg">MISI√ìN 2</div>
                <div class="text-4xl text-yellow-300">‚ö†Ô∏è</div>
            </div>
            <div id="completion-badge" class="hidden px-4 py-2 bg-green-500 text-white font-bold rounded-full shadow-lg">
                ‚úÖ Completada
            </div>
        </div>
    </header>

    <main class="relative z-10 p-6 md:p-10 max-w-4xl mx-auto">
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-white/30 shadow-2xl mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-center mb-4 text-yellow-300">
                Milo en Zycurva: Evita el Abismo
            </h2>
            <p class="text-lg text-white/90 text-center mb-6">
                En el planeta Zycurva, la superficie est√° llena de grietas y abismos energ√©ticos.
                Tu misi√≥n es programar a <span class="font-semibold text-yellow-300">Milo</span> para avanzar en l√≠nea recta y
                usar su sensor de movimiento como un escudo inteligente que le avise cuando est√° demasiado cerca del vac√≠o.
                Si el sensor no funciona bien, Milo podr√≠a caer. Si lo programas con precisi√≥n‚Ä¶ se convertir√° en un verdadero explorador espacial.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                <div>
                    <img src="mision2.png" alt="Milo explorando el borde del abismo en Zycurva" 
                         class="w-full rounded-2xl border-4 border-white/50 shadow-xl"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-auto aspect-video flex items-center justify-center text-4xl md:text-6xl bg-gradient-to-br from-pink-400 via-teal-400 to-green-400&quot;>üõ∞Ô∏è</div>'">
                </div>
                <div class="bg-black/40 p-4 rounded-xl border-2 border-white/40">
                    <h3 class="text-xl md:text-2xl font-semibold mb-3 text-white">Objetivo de la misi√≥n</h3>
                    <ul class="list-disc list-inside space-y-2 text-white/90">
                        <li>Usar el sensor de movimiento de Milo para detectar el borde del abismo.</li>
                        <li>Programar un algoritmo que detenga y haga retroceder a Milo antes de caer.</li>
                        <li>Medir y registrar distancias para comprobar si la programaci√≥n es segura.</li>
                        <li>Explicar, con lenguaje sencillo, c√≥mo el sensor ‚Äútoma decisiones‚Äù para proteger a Milo.</li>
                    </ul>
                </div>
            </div>

            <!-- Fase Preparaci√≥n -->
            <div class="mt-8 bg-black/40 p-5 rounded-2xl border border-white/20">
                <h3 class="text-xl font-semibold text-yellow-300 mb-2">1. Preparaci√≥n (Docente)</h3>
                <p class="text-white/90 mb-2">
                    Antes de comenzar, organiza el escenario de Zycurva:
                </p>
                <ul class="list-disc list-inside space-y-1 text-white/80">
                    <li>Marca una <span class="font-semibold">l√≠nea de inicio</span> para Milo.</li>
                    <li>Delimita el <span class="font-semibold">‚Äúabismo‚Äù</span> con cinta negra, una cartulina o el borde de la mesa (sin riesgo real).</li>
                    <li>Aseg√∫rate de que Milo solo pueda avanzar y retroceder en l√≠nea recta.</li>
                    <li>Ten lista la conexi√≥n con el software de programaci√≥n (WeDo / Scratch seg√∫n corresponda).</li>
                </ul>
            </div>

            <!-- Fase Explorar -->
            <div class="mt-6 bg-black/30 p-5 rounded-2xl border border-white/10">
                <h3 class="text-xl font-semibold text-yellow-300 mb-2">2. Fase Explorar (Preguntas iniciales)</h3>
                <p class="text-white/90 mb-2">
                    Conversa brevemente con tu equipo de exploradores:
                </p>
                <ul class="list-disc list-inside space-y-1 text-white/80">
                    <li>¬øC√≥mo sabe un robot que est√° cerca de un lugar peligroso si nadie le avisa?</li>
                    <li>Si Milo no puede ver, ¬øqu√© puede usar en su lugar para decidir cu√°ndo detenerse?</li>
                    <li>¬øPor qu√© es importante medir bien la distancia hasta el borde?</li>
                </ul>
                <p class="mt-2 text-white/80">
                    Aqu√≠ introducimos la idea de que un sensor entrega informaci√≥n y que el programa sigue
                    <span class="font-semibold">instrucciones claras (algoritmo)</span> para actuar a tiempo.
                </p>
            </div>

            <!-- Fase Crear -->
            <div class="mt-6 bg-black/40 p-5 rounded-2xl border border-blue-300/30">
                <h3 class="text-xl font-semibold text-yellow-300 mb-2">3. Fase Crear (Programar a Milo)</h3>
                <p class="text-white/90 mb-3">
                    Los estudiantes construyen a Milo con el sensor de movimiento apuntando hacia adelante
                    (o ligeramente hacia abajo) y programan esta misi√≥n:
                </p>
                <ol class="list-decimal list-inside space-y-1 text-white/80 mb-3">
                    <li>Milo avanza en l√≠nea recta hacia el abismo.</li>
                    <li>El sensor detecta cuando est√° demasiado cerca del borde.</li>
                    <li>Al detectar el borde:
                        <ul class="list-disc list-inside ml-5 space-y-1">
                            <li>Se detiene inmediatamente.</li>
                            <li>Emite un sonido de alerta.</li>
                            <li>Retrocede durante un tiempo corto para ponerse a salvo.</li>
                        </ul>
                    </li>
                </ol>
                <p class="text-white/80 mb-2">
                    Para guiar su pensamiento computacional, expl√≠cales que est√°n creando un
                    <span class="font-semibold">algoritmo de seguridad</span>:
                </p>
                <pre class="bg-black/70 text-xs md:text-sm p-3 rounded-xl border border-white/10 whitespace-pre-wrap text-white/90">
Al presionar inicio:
1. Repetir mientras sea seguro:
   - Avanzar
   - Leer el sensor
2. Si el sensor detecta que est√° cerca del borde:
   - Detenerse
   - Hacer sonido de alerta
   - Retroceder
                </pre>
                <p class="mt-3 text-white/80">
                    Integra pensamiento matem√°tico:
                </p>
                <ul class="list-disc list-inside space-y-1 text-white/80">
                    <li>Marcar y medir la distancia desde la salida hasta el borde (por ejemplo: 30 cm, 40 cm).</li>
                    <li>Registrar cu√°ntos cent√≠metros antes del borde se detiene Milo en cada intento.</li>
                    <li>Comparar ensayos y decidir si el programa es seguro o necesita ajustes.</li>
                </ul>
            </div>

            <!-- Fase Compartir -->
            <div class="mt-6 bg-black/30 p-5 rounded-2xl border border-green-300/20">
                <h3 class="text-xl font-semibold text-yellow-300 mb-2">4. Fase Compartir (Evidencia de misi√≥n)</h3>
                <ul class="list-disc list-inside space-y-1 text-white/80">
                    <li>Grabar un v√≠deo corto donde se vea a Milo acerc√°ndose al abismo y deteni√©ndose a tiempo.</li>
                    <li>Que un integrante explique:
                        <ul class="list-disc list-inside ml-5">
                            <li>Qu√© hace el sensor.</li>
                            <li>Qu√© instrucciones usaron para proteger a Milo.</li>
                            <li>Qu√© midieron (distancia) y c√≥mo mejoraron su programa.</li>
                        </ul>
                    </li>
                    <li>Opcional: mostrar una tabla sencilla con sus ensayos (distancia medida vs. distancia real de frenado).</li>
                </ul>
                <p class="mt-3 text-white/70 text-sm">
                    As√≠ conectan ciencia, tecnolog√≠a, matem√°ticas y toma de decisiones como verdaderos equipos de exploraci√≥n espacial.
                </p>
            </div>

            <!-- Botones de misi√≥n -->
            <div class="mt-8 flex justify-center gap-4">
                <button id="complete-btn" onclick="completeMission()" class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                    Completar Misi√≥n
                </button>
                <a href="index.html" id="completed-btn" class="hidden px-6 py-3 bg-white text-green-600 font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                    Volver a Misiones
                </a>
            </div>
        </section>
    </main>

    <script>
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        function getCurrentPlayer() {
            return localStorage.getItem('zython-current-player');
        }

        function loadPlayerProgress(playerName) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                return players[playerName] || { completedMissions: [], completed: 0, currentMission: 1, available: 1, badges: 0 };
            } catch (error) {
                console.error('Error loading progress:', error);
                return { completedMissions: [], completed: 0, currentMission: 1, available: 1, badges: 0 };
            }
        }

        function savePlayerProgress(playerName, progress) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                players[playerName] = progress;
                localStorage.setItem('zython-players', JSON.stringify(players));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function checkCompletion() {
            const currentPlayer = getCurrentPlayer();
            if (currentPlayer) {
                const progress = loadPlayerProgress(currentPlayer);
                if (progress.completedMissions.includes(2)) {
                    document.getElementById('completion-badge').classList.remove('hidden');
                    document.getElementById('complete-btn').classList.add('hidden');
                    document.getElementById('completed-btn').classList.remove('hidden');
                }
            }
        }

        function completeMission() {
            const currentPlayer = getCurrentPlayer();
            if (!currentPlayer) {
                console.error('No current player for mission completion');
                alert('Error: No se encontr√≥ informaci√≥n del jugador. Por favor, regresa al men√∫ principal.');
                return;
            }
            
            const progress = loadPlayerProgress(currentPlayer);
            
            if (!progress.completedMissions.includes(2)) {
                progress.completedMissions.push(2);
                progress.completed = progress.completedMissions.length;
                progress.badges = progress.completedMissions.length;
                
                // Desbloquear Misi√≥n 3
                progress.currentMission = 3;
                progress.available = Math.max(progress.available, 3);
                
                savePlayerProgress(currentPlayer, progress);
                
                document.getElementById('completion-badge').classList.remove('hidden');
                document.getElementById('complete-btn').classList.add('hidden');
                document.getElementById('completed-btn').classList.remove('hidden');
                
                alert('¬°Felicitaciones! Has completado la Misi√≥n 2: Milo en Zycurva ‚Äì Evita el Abismo. La Misi√≥n 3 ahora est√° disponible.');
            } else {
                alert('Esta misi√≥n ya ha sido completada anteriormente.');
            }
        }

        function volverAMisiones() {
            window.location.href = 'index.html';
        }

        function initialize() {
            createStars();
            checkCompletion();
        }

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
