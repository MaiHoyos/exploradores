<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi√≥n 2: RoverBot en Zycurva ‚Äì Evita el Abismo</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Exo 2', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .slide {
            display: none;
        }

        .slide.active {
            display: block;
        }

        .orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        input[type="number"], input[type="text"] {
            background-color: rgba(15,23,42,0.8);
            border-radius: 0.5rem;
            padding: 0.15rem 0.35rem;
            border: 1px solid rgba(248,250,252,0.2);
            width: 100%;
            color: #e5e7eb;
            font-size: 0.75rem;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-black text-white relative overflow-auto">
    <div class="stars" id="stars"></div>
    
    <!-- ENCABEZADO -->
    <header class="relative z-10 bg-gradient-to-r from-blue-400 to-blue-600 border-4 border-white rounded-b-3xl p-6 m-4">
        <div class="flex items-center justify-between">
            <button onclick="volverAMisiones()" class="px-4 py-2 bg-white text-blue-600 font-bold rounded-full shadow-lg transition-transform transform hover:scale-105">
                ‚Üê Volver a Misiones
            </button>
            <div class="flex items-center space-x-4">
                <div class="text-3xl font-extrabold text-white drop-shadow-lg orbitron">MISI√ìN 2</div>
                <div class="text-4xl text-yellow-300">‚ö†Ô∏è</div>
            </div>
            <div id="completion-badge" class="hidden px-4 py-2 bg-green-500 text-white font-bold rounded-full shadow-lg">
                ‚≠ê Insignia ganada
            </div>
        </div>
        <p class="mt-3 text-sm md:text-base text-white/90 text-right">
            Planeta Zycurva ¬∑ Uso del sensor de movimiento ¬∑ Pensamiento matem√°tico y computacional
        </p>
    </header>

    <!-- CONTENIDO PRINCIPAL -->
    <main class="relative z-10 p-6 md:p-10 max-w-4xl mx-auto">
        <section class="bg-white/10 backdrop-blur-sm rounded-3xl p-6 md:p-8 border-4 border-white/30 shadow-2xl mb-8">

            <!-- Indicador de diapositivas -->
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-300">
                    RoverBot en Zycurva: Evita el Abismo
                </h2>
                <div id="slide-indicator" class="text-sm text-white/80">
                    Diapositiva <span id="current-slide">1</span> de <span id="total-slides">10</span>
                </div>
            </div>

            <!-- SLIDE 1: Introducci√≥n narrativa -->
            <div class="slide active" data-slide="1">
                <p class="text-lg text-white/90 mb-4">
                    Has llegado al <span class="font-semibold text-yellow-300">Planeta Zycurva</span>, una superficie inestable llena de grietas profundas y abismos energ√©ticos.
                    Tu explorador, <span class="font-semibold">RoverBot</span>, solo puede avanzar y retroceder en l√≠nea recta, pero un paso en falso puede hacerlo caer al vac√≠o.
                </p>
                <p class="text-white/90 mb-4">
                    Tu misi√≥n es convertir el <span class="font-semibold">sensor de movimiento</span> de RoverBot en su mejor aliado:
                    un sistema de alerta inteligente que le indique cu√°ndo detenerse antes del borde.
                    Para lograrlo, tendr√°s que pensar como cient√≠fico, programador y matem√°tico al mismo tiempo.
                </p>

                <!-- Espacio para ilustraci√≥n de portada -->
                <div class="mt-6">
                    <!-- <img src="RoverBot_Zycurva_Portada.png" ...> -->
                    <div class="w-full aspect-video flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm">
                        Espacio para ilustraci√≥n de portada (RoverBot frente al abismo en Zycurva).
                    </div>
                </div>
            </div>

            <!-- SLIDE 2: Preparaci√≥n + Sensor/1 -->
            <div class="slide" data-slide="2">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">1. Preparaci√≥n en Zycurva</h3>
                <p class="text-white/90 mb-3">
                    Antes de enviar a RoverBot hacia el borde, prepara el escenario de forma segura:
                </p>
                <ul class="list-disc list-inside space-y-2 text-white/85 mb-4">
                    <li>Marca una <span class="font-semibold">l√≠nea de inicio</span> desde donde partir√° RoverBot.</li>
                    <li>Delimita el <span class="font-semibold">‚Äúabismo‚Äù</span> con cinta negra, cartulina oscura o el borde de la mesa (sin riesgo real).</li>
                    <li>Aseg√∫rate de que RoverBot solo se mueva en l√≠nea recta: adelante y atr√°s.</li>
                    <li>Conecta el hub y verifica el funcionamiento del motor y del sensor de movimiento.</li>
                    <li>Aseg√∫rate de tener la carpeta <span class="font-semibold">‚ÄúSensor‚Äù</span> con las im√°genes de construcci√≥n.</li>
                    <li>Abre el entorno de programaci√≥n por bloques listo para programar.</li>
                </ul>

                <!-- Imagen 1 del sensor en Preparaci√≥n -->
                <div class="mt-4">
                    <img src="Sensor/1.jpg"
                         class="w-full rounded-2xl border-4 border-white/40 shadow-xl"
                         alt="Paso 1 construcci√≥n del sensor de RoverBot"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full aspect-video flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm&quot;>Espacio para la imagen Sensor/1 (inicio construcci√≥n del sensor).</div>'">
                </div>
            </div>

            <!-- SLIDE 3: Construcci√≥n del sensor ‚Äì Parte 1 (1-3) -->
            <div class="slide" data-slide="3">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">2. Construcci√≥n del Sensor ‚Äì Parte 1</h3>
                <p class="text-white/90 mb-3">
                    Vas a construir el <span class="font-semibold">brazo con sensor de movimiento</span> que permitir√° a RoverBot detectar el borde del abismo.
                    Sigue los pasos en orden.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/1.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 1 Sensor">
                        <span>Paso 1</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/2.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 2 Sensor">
                        <span>Paso 2</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/3.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 3 Sensor">
                        <span>Paso 3</span>
                    </div>
                </div>

                <p class="mt-4 text-white/80 text-sm">
                    ‚úî Aseg√∫rate de que las piezas encajen bien. El sensor debe ir firme para poder ‚Äúver‚Äù el peligro.
                </p>
            </div>

            <!-- SLIDE 4: Construcci√≥n del sensor ‚Äì Parte 2 (4-6) -->
            <div class="slide" data-slide="4">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">2. Construcci√≥n del Sensor ‚Äì Parte 2</h3>
                <p class="text-white/90 mb-3">
                    Contin√∫a reforzando la estructura del brazo sensor. Observa c√≥mo se asegura la base.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/4.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 4 Sensor">
                        <span>Paso 4</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/5.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 5 Sensor">
                        <span>Paso 5</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/6.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 6 Sensor">
                        <span>Paso 6</span>
                    </div>
                </div>

                <p class="mt-4 text-white/80 text-sm">
                    üîç Revisa que el brazo quede estable y que el sensor no se mueva suelto.
                </p>
            </div>

            <!-- SLIDE 5: Construcci√≥n del sensor ‚Äì Parte 3 (7-9) -->
            <div class="slide" data-slide="5">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">2. Construcci√≥n del Sensor ‚Äì Parte 3</h3>
                <p class="text-white/90 mb-3">
                    Termina de armar el brazo. Aqu√≠ defines la posici√≥n donde el sensor mirar√° hacia adelante.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/7.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 7 Sensor">
                        <span>Paso 7</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/8.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 8 Sensor">
                        <span>Paso 8</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/9.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 9 Sensor">
                        <span>Paso 9</span>
                    </div>
                </div>

                <p class="mt-4 text-white/80 text-sm">
                    üí° Verifica que el sensor ‚Äúapunte‚Äù hacia el frente, listo para detectar el borde.
                </p>
            </div>

            <!-- SLIDE 6: Construcci√≥n del sensor ‚Äì Final (10-11) -->
            <div class="slide" data-slide="6">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">2. Construcci√≥n del Sensor ‚Äì Final</h3>
                <p class="text-white/90 mb-3">
                    A√±ade las √∫ltimas piezas y conecta el sensor al hub. El sistema de seguridad de RoverBot est√° casi listo.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/10.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 10 Sensor">
                        <span>Paso 10</span>
                    </div>
                    <div class="flex flex-col items-center text-xs text-white/70">
                        <img src="Sensor/11.jpg" class="w-full rounded-xl border border-white/30 mb-1" alt="Paso 11 Sensor">
                        <span>Paso 11</span>
                    </div>
                </div>

                <p class="mt-4 text-white/75 text-xs">
                    Imagen ¬©2015 The LEGO Group. Usada con fines educativos y sin √°nimo de lucro.  
                    Fuente: Instrucciones de construcci√≥n del set LEGO¬Æ Education WeDo 2.0 (45300).
                </p>
            </div>

            <!-- SLIDE 7: Fase Explorar -->
            <div class="slide" data-slide="7">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">3. Fase Explorar</h3>
                <p class="text-white/90 mb-3">
                    Con RoverBot listo, tu equipo reflexiona:
                </p>
                <ul class="list-disc list-inside space-y-2 text-white/85 mb-4">
                    <li>Si un robot no ve como nosotros, ¬øc√≥mo puede saber que est√° cerca de un lugar peligroso?</li>
                    <li>¬øQu√© pasar√≠a si RoverBot no se detiene a tiempo antes del abismo?</li>
                    <li>¬øPor qu√© los cient√≠ficos necesitan medir con precisi√≥n para tomar decisiones seguras?</li>
                </ul>
                <p class="text-white/80 mb-2">
                    El sensor funciona como un <span class="font-semibold">‚Äúojo cient√≠fico‚Äù</span> que env√≠a informaci√≥n, y el programa ser√° un
                    <span class="font-semibold">algoritmo</span>: una lista ordenada de instrucciones que RoverBot debe seguir sin saltarse pasos.
                </p>
                <p class="text-white/80 font-semibold">
                    üíæ Tarea del equipo: escriban sus respuestas en un documento Word titulado
                    <span class="italic">‚ÄúM2_Zycurva_FaseExplorar_NombreEquipo‚Äù</span> y gu√°rdenlo en la carpeta de la misi√≥n en Drive.
                </p>

                <div class="mt-4">
                    <div class="w-full h-40 flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm">
                        Espacio para ilustraci√≥n del equipo reflexionando sobre c√≥mo ayudar a RoverBot.
                    </div>
                </div>
            </div>

            <!-- SLIDE 8: Fase Crear (pseudoc√≥digo) -->
            <div class="slide" data-slide="8">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">4. Fase Crear: Algoritmo de Seguridad</h3>
                <p class="text-white/90 mb-3">
                    Antes de programar con bloques, tu equipo escribe el <span class="font-semibold">pseudoc√≥digo</span>:
                    lo que quieren que haga RoverBot paso a paso.
                </p>
                <ol class="list-decimal list-inside space-y-2 text-white/85 mb-3">
                    <li>RoverBot avanza desde la l√≠nea de inicio hacia el abismo.</li>
                    <li>El sensor de movimiento observa mientras se mueve.</li>
                    <li>Cuando detecta que est√° demasiado cerca del borde:
                        <ul class="list-disc list-inside ml-5 space-y-1">
                            <li>El motor se detiene.</li>
                            <li>RoverBot emite un sonido de alerta.</li>
                            <li>Retrocede durante un tiempo corto para ponerse a salvo.</li>
                        </ul>
                    </li>
                </ol>

                <p class="text-white/80 mb-2">Ejemplo de pseudoc√≥digo:</p>
                <pre class="bg-black/70 text-xs md:text-sm p-3 rounded-xl border border-white/10 whitespace-pre-wrap text-white/90">
AL INICIAR:
  MIENTRAS RoverBot EST√â LEJOS DEL BORDE:
      AVANZAR
      LEER SENSOR
  SI EL SENSOR DETECTA BORDE:
      DETENER MOTOR
      HACER SONIDO DE ALERTA
      RETROCEDER 2 SEGUNDOS
                </pre>

                <p class="text-white/80 font-semibold mb-2">
                    ‚úçÔ∏è Tarea: escriban su propio pseudoc√≥digo en el mismo documento de la misi√≥n en Drive,
                    antes de pasar a la programaci√≥n por bloques.
                </p>

                <div class="mt-4">
                    <div class="w-full aspect-video flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm">
                        Espacio para diagrama de flujo o captura del pseudoc√≥digo del equipo.
                    </div>
                </div>
            </div>

            <!-- SLIDE 9: Registrar y Analizar (tabla editable) -->
            <div class="slide" data-slide="9">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">5. Registrar y Analizar: ¬øEs un programa seguro?</h3>
                <p class="text-white/90 mb-3">
                    Ahora deben comprobar con datos si el programa realmente protege a RoverBot:
                </p>
                <ul class="list-disc list-inside space-y-2 text-white/85 mb-4">
                    <li>Midan la distancia desde la l√≠nea de inicio hasta el abismo (ejemplo: 40 cm).</li>
                    <li>Ejecuten el programa varias veces.</li>
                    <li>En cada ensayo, midan a cu√°ntos cent√≠metros del borde se detuvo RoverBot.</li>
                    <li>Reg√≠strenlo en la tabla y analicen los resultados.</li>
                </ul>

                <div class="overflow-x-auto mb-3">
                    <table class="w-full text-xs md:text-sm text-left border border-white/20">
                        <thead class="bg-white/10">
                            <tr>
                                <th class="px-2 py-1 border-b border-white/20">Ensayo</th>
                                <th class="px-2 py-1 border-b border-white/20">Distancia al borde (cm)</th>
                                <th class="px-2 py-1 border-b border-white/20">Distancia donde se detuvo RoverBot (cm)</th>
                                <th class="px-2 py-1 border-b border-white/20">¬øSe detuvo a tiempo?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Filas con inputs para que puedan introducir datos -->
                            <tr>
                                <td class="px-2 py-1 border-b border-white/10">1</td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1" placeholder="40"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="text" placeholder="S√≠ / No"></td>
                            </tr>
                            <tr>
                                <td class="px-2 py-1 border-b border-white/10">2</td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1" placeholder="40"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="text" placeholder="S√≠ / No"></td>
                            </tr>
                            <tr>
                                <td class="px-2 py-1 border-b border-white/10">3</td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1" placeholder="40"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="text" placeholder="S√≠ / No"></td>
                            </tr>
                            <tr>
                                <td class="px-2 py-1 border-b border-white/10">4</td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1" placeholder="40"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="number" min="0" step="1"></td>
                                <td class="px-2 py-1 border-b border-white/10"><input type="text" placeholder="S√≠ / No"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="text-white/80 font-semibold">
                    Analicen si RoverBot siempre se detiene a una distancia segura.
                    Si en alg√∫n ensayo queda demasiado cerca del borde, ajusten el programa
                    y registren sus conclusiones en el documento de la misi√≥n en Drive.
                </p>

                <div class="mt-4">
                    <div class="w-full h-40 flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm">
                        Espacio para imagen o gr√°fica con los resultados de los ensayos.
                    </div>
                </div>
            </div>

            <!-- SLIDE 10: Compartir + insignia + volver -->
            <div class="slide" data-slide="10">
                <h3 class="text-xl font-semibold text-yellow-300 mb-3">6. Fase Compartir: Informe de la Misi√≥n</h3>
                <ul class="list-disc list-inside space-y-2 text-white/85 mb-4">
                    <li>Graben un v√≠deo corto donde se vea a RoverBot acerc√°ndose al abismo y deteni√©ndose a tiempo.</li>
                    <li>En el v√≠deo, un integrante explica:
                        <ul class="list-disc list-inside ml-5 space-y-1">
                            <li>C√≥mo usa RoverBot el sensor de movimiento para evitar el abismo.</li>
                            <li>Qu√© instrucciones del algoritmo lo protegen.</li>
                            <li>Qu√© observaron en la tabla de datos y qu√© ajustes realizaron.</li>
                        </ul>
                    </li>
                    <li>Suban el v√≠deo y el documento con respuestas, pseudoc√≥digo y tabla a la carpeta de la misi√≥n en Drive.</li>
                </ul>

                <div class="mt-2 mb-6">
                    <div class="w-full h-32 flex items-center justify-center rounded-2xl border-2 border-dashed border-white/40 text-white/60 text-center text-sm">
                        Espacio para imagen del equipo presentando la misi√≥n completa.
                    </div>
                </div>

                <p class="text-white/80 font-semibold mb-4">
                    ‚úÖ Cuando terminen todas las tareas, hagan clic en <span class="underline">‚ÄúCompletar Misi√≥n‚Äù</span> para ganar la
                    insignia <span class="text-yellow-300">"Guardianes del Abismo de Zycurva"</span> y regresar al mapa de misiones.
                </p>

                <!-- Botones de misi√≥n -->
                <div class="flex justify-center gap-4">
                    <button id="complete-btn" onclick="completeMission()" class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                        Completar Misi√≥n
                    </button>
                    <a href="index.html" id="completed-btn" class="hidden px-6 py-3 bg-white text-green-600 font-bold text-lg rounded-full shadow-lg transition-transform transform hover:scale-110 hover:shadow-2xl">
                        Volver a Misiones
                    </a>
                </div>
            </div>

            <!-- CONTROLES DE NAVEGACI√ìN -->
            <div class="mt-8 flex justify-between items-center">
                <button id="prev-slide" class="px-4 py-2 bg-white/10 border border-white/40 rounded-full text-white/80 text-sm hover:bg-white/20 hover:scale-105 transition" onclick="changeSlide(-1)">
                    ‚Üê Anterior
                </button>
                <button id="next-slide" class="px-4 py-2 bg-blue-500 rounded-full text-white font-semibold text-sm hover:bg-blue-600 hover:scale-105 transition" onclick="changeSlide(1)">
                    Siguiente ‚Üí
                </button>
            </div>

        </section>
    </main>

    <script>
        // Estrellas de fondo
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Progreso por jugador
        function getCurrentPlayer() {
            return localStorage.getItem('zython-current-player');
        }

        function loadPlayerProgress(playerName) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                return players[playerName] || { completedMissions: [], completed: 0, currentMission: 1, available: 1, badges: 0 };
            } catch (error) {
                console.error('Error loading progress:', error);
                return { completedMissions: [], completed: 0, currentMission: 1, available: 1, badges: 0 };
            }
        }

        function savePlayerProgress(playerName, progress) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                players[playerName] = progress;
                localStorage.setItem('zython-players', JSON.stringify(players));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function checkCompletion() {
            const currentPlayer = getCurrentPlayer();
            if (currentPlayer) {
                const progress = loadPlayerProgress(currentPlayer);
                if (progress.completedMissions.includes(2)) {
                    const badge = document.getElementById('completion-badge');
                    if (badge) badge.classList.remove('hidden');
                    const completeBtn = document.getElementById('complete-btn');
                    const completedBtn = document.getElementById('completed-btn');
                    if (completeBtn) completeBtn.classList.add('hidden');
                    if (completedBtn) completedBtn.classList.remove('hidden');
                }
            }
        }

        // Completar misi√≥n
        function completeMission() {
            const currentPlayer = getCurrentPlayer();
            if (!currentPlayer) {
                console.error('No current player for mission completion');
                alert('Error: No se encontr√≥ informaci√≥n del jugador. Por favor, regresa al men√∫ principal.');
                return;
            }
            
            const progress = loadPlayerProgress(currentPlayer);
            
            if (!progress.completedMissions.includes(2)) {
                progress.completedMissions.push(2);
                progress.completed = progress.completedMissions.length;
                progress.badges = progress.completedMissions.length;
                progress.currentMission = 3;
                progress.available = Math.max(progress.available, 3);
                
                savePlayerProgress(currentPlayer, progress);
                
                const badge = document.getElementById('completion-badge');
                if (badge) badge.classList.remove('hidden');
                const completeBtn = document.getElementById('complete-btn');
                const completedBtn = document.getElementById('completed-btn');
                if (completeBtn) completeBtn.classList.add('hidden');
                if (completedBtn) completedBtn.classList.remove('hidden');
                
                alert('¬°Misi√≥n completada! Has obtenido la insignia "Guardianes del Abismo de Zycurva". La Misi√≥n 3 ahora est√° disponible.');
            } else {
                alert('Esta misi√≥n ya ha sido completada anteriormente.');
            }
        }

        function volverAMisiones() {
            window.location.href = 'index.html';
        }

        // Navegaci√≥n entre diapositivas
        let currentSlide = 1;

        function updateSlideVisibility() {
            const slides = document.querySelectorAll('.slide');
            const total = slides.length;

            slides.forEach(slide => {
                const n = parseInt(slide.getAttribute('data-slide'));
                slide.classList.toggle('active', n === currentSlide);
            });

            // Actualizar indicador
            const currentSpan = document.getElementById('current-slide');
            const totalSpan = document.getElementById('total-slides');
            if (currentSpan) currentSpan.textContent = currentSlide;
            if (totalSpan) totalSpan.textContent = total;

            // Mostrar/ocultar botones
            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');

            if (currentSlide === 1) {
                prevBtn.classList.add('invisible');
            } else {
                prevBtn.classList.remove('invisible');
            }

            if (currentSlide === total) {
                nextBtn.classList.add('hidden');
            } else {
                nextBtn.classList.remove('hidden');
            }
        }

        function changeSlide(delta) {
            const slides = document.querySelectorAll('.slide');
            const total = slides.length;
            currentSlide += delta;
            if (currentSlide < 1) currentSlide = 1;
            if (currentSlide > total) currentSlide = total;
            updateSlideVisibility();
        }

        function initialize() {
            createStars();
            checkCompletion();
            updateSlideVisibility();
        }

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
