<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misi√≥n 2: Corredor de Cr√°teres del Sensorium</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Fredoka', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* Fondo animado con gradiente din√°mico */
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        body {
            background: linear-gradient(-45deg, #1a0a3e, #2d1b69, #0f172a, #1e293b);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }

        /* Estrellas mejoradas con brillo */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
            box-shadow: 0 0 4px rgba(255, 255, 255, 0.8);
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Estrellas fugaces ocasionales */
        @keyframes shootingStar {
            0% {
                transform: translateX(0) translateY(0) rotate(-45deg);
                opacity: 1;
            }
            100% {
                transform: translateX(-300px) translateY(300px) rotate(-45deg);
                opacity: 0;
            }
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 60px;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1));
            animation: shootingStar 1s ease-out;
            pointer-events: none;
        }

        .sheet-title {
            font-family: 'Fredoka', sans-serif;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.6), 0 0 40px rgba(251, 191, 36, 0.3);
        }

        /* Transiciones suaves entre hojas */
        .sheet {
            display: none;
            animation: fadeInScale 0.5s ease-out;
        }

        .sheet.active {
            display: flex;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Efecto vidrio esmerilado en cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Hover effects mejorados en botones */
        .btn-3d {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), 0 0 20px rgba(168, 85, 247, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.3), 0 0 30px rgba(168, 85, 247, 0.6);
        }

        .btn-3d:active {
            transform: translateY(0);
        }

        /* Efecto pulso en badges */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .badge-pulse {
            animation: pulse 2s infinite;
        }

        /* Im√°genes con hover effect */
        .hover-lift {
            transition: all 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        /* Tabla mejorada */
        .table-row {
            transition: all 0.2s ease;
        }

        .table-row:hover {
            background: rgba(168, 85, 247, 0.2);
            transform: scale(1.01);
        }

        /* Estilos para bot√≥n de audio */
        .audio-toggle {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 1000;
            background: rgba(168, 85, 247, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 0.75rem 1.25rem;
            border-radius: 9999px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(168, 85, 247, 0.4);
        }

        .audio-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 35px rgba(168, 85, 247, 0.6);
        }

        .audio-toggle.active {
            background: rgba(16, 185, 129, 0.9);
        }
    </style>
</head>
<body class="min-h-screen text-white relative overflow-hidden">
    <div class="stars" id="stars"></div>
    
    <!-- Agregando bot√≥n de control de audio -->
    <button id="audio-toggle" class="audio-toggle active" onclick="toggleAudio()">
        üîä Audio ON
    </button>
    
    <!-- Header mejorado con efectos glassmorphism -->
    <header class="relative z-20 glass-card bg-gradient-to-r from-purple-600/80 to-purple-500/80 rounded-b-3xl p-4 md:p-6 m-3 md:m-4">
        <div class="flex flex-wrap items-center justify-between gap-4">
            <button onclick="volverAMisiones()" class="px-5 py-2.5 bg-white text-purple-600 font-bold rounded-full shadow-lg btn-3d">
                ‚Üê Volver a Misiones
            </button>
            <div class="flex items-center gap-3">
                <div class="text-2xl md:text-3xl font-extrabold text-white sheet-title">MISI√ìN 2 ¬∑ Sensorium</div>
                <div class="text-3xl md:text-4xl">üååü§ù</div>
            </div>
            <div id="completion-badge" class="hidden px-4 py-2 bg-green-500 text-white font-bold rounded-full shadow-lg text-xs md:text-sm badge-pulse">
                üèÖ Insignia: Colaboraci√≥n en Sensorium
            </div>
        </div>
        <div class="mt-1 text-[11px] md:text-sm text-purple-100 text-right">
            Hoja <span id="sheet-indicator" class="font-bold text-yellow-300">1</span> de <span id="sheet-total" class="font-bold">10</span>
        </div>
    </header>

    <main class="relative z-10 px-4 md:px-8 max-w-5xl mx-auto">
        <div id="sheet-container" class="h-[calc(100vh-230px)] flex items-center justify-center">
            <!-- Hoja 1 con mejor dise√±o y espaciado -->
            <section id="sheet-1" class="sheet active w-full max-w-5xl h-full glass-card rounded-3xl p-5 md:p-6 shadow-2xl flex-col justify-center space-y-4 overflow-y-auto">
                <h2 class="sheet-title text-2xl md:text-3xl font-bold text-center text-yellow-300">
                    Hoja 1 ¬∑ Corredor de Cr√°teres del Sensorium
                </h2>
                <p class="text-sm md:text-base text-white/90 text-center px-2">
                    En el planeta <span class="font-bold text-teal-300">Sensorium</span>, dos RoverBots deben colaborar para transportar una valiosa muestra de energ√≠a
                    hasta un punto exacto del mapa. El camino est√° lleno de cr√°teres y zonas inestables.
                    Solo lo lograr√°n si planifican <span class="font-semibold text-yellow-300">trayectorias con giros y √°ngulos precisos</span>
                    y trabajan como un equipo cient√≠fico.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                    <div>
                        <img src="mision3_sensorium.png"
                            alt="Corredor de cr√°teres en Sensorium"
                            class="w-full rounded-2xl border-2 border-white/60 shadow-xl hover-lift"
                            onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full aspect-video flex items-center justify-center text-5xl bg-gradient-to-br from-purple-500 via-blue-500 to-black rounded-2xl border-2 border-white/40 hover-lift&quot;>üååüï≥Ô∏èüï≥Ô∏è</div>'">
                    </div>
                    <div class="glass-card p-4 rounded-2xl space-y-2">
                        <h3 class="text-base md:text-lg font-semibold text-white">Objetivo de la misi√≥n</h3>
                        <ul class="list-disc list-inside text-sm md:text-base text-white/90 space-y-1">
                            <li>Unir dos RoverBots para transportar una misma carga.</li>
                            <li>Dise√±ar un recorrido con cambios de direcci√≥n y √°ngulos.</li>
                            <li>Esquivar cr√°teres y zonas peligrosas.</li>
                            <li>Detenerse exactamente en el punto de entrega marcado.</li>
                        </ul>
                    </div>
                </div>

                <div class="space-y-1 text-sm md:text-base">
                    <p class="font-semibold text-purple-300">Conceptos matem√°ticos:</p>
                    <ul class="list-disc list-inside text-white/90 space-y-1">
                        <li>Distancias en cent√≠metros o cuadros.</li>
                        <li>√Ångulos (90¬∞, 45¬∞, 135¬∞, 180¬∞).</li>
                        <li>Relaci√≥n potencia‚Äìtiempo‚Äìdistancia.</li>
                        <li>Recorridos en un plano (trayectorias).</li>
                    </ul>
                </div>
            </section>

            <!-- Hoja 2 mejorada -->
            <section id="sheet-2" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 md:p-6 shadow-2xl flex-col justify-center space-y-4 overflow-y-auto">
                <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center">
                    Hoja 2 ¬∑ Dise√±a tu trayectoria segura en Sensorium
                </h2>
                <p class="text-sm md:text-base text-white/90 px-2 text-center">
                    Momento STEAM üé®: En equipos, <span class="font-semibold text-teal-300">crea el escenario</span> de Sensorium.
                </p>
                <ul class="list-disc list-inside text-sm md:text-base text-white/90 px-6 space-y-1">
                    <li>Pinta o construye con materiales simples los cr√°teres, monta√±as y rocas.</li>
                    <li>Marca el <span class="font-semibold">Punto A</span>: salida de los RoverBots.</li>
                    <li>La profe se√±alar√° el <span class="font-semibold">Punto B</span>: lugar exacto de entrega.</li>
                    <li>Dibuja al menos <span class="font-semibold">2 cr√°teres</span> que deben esquivar.</li>
                </ul>

                <div class="glass-card rounded-2xl p-4 space-y-2">
                    <p class="font-semibold text-yellow-300">Ahora escribe el plan en tus palabras (pseudoc√≥digo):</p>
                    <p class="text-sm md:text-base">
                        1Ô∏è‚É£ Coloca los RoverBots en el Punto A.<br>
                        2Ô∏è‚É£ Observa el escenario: ¬øcu√°ntos pasos rectos?, ¬ød√≥nde girar?, ¬øqu√© √°ngulos usar?<br>
                        3Ô∏è‚É£ En un archivo Word llamado <strong>"Misi√≥n 2 - Sensorium - Pseudoc√≥digo"</strong>,
                        escribe la secuencia con tus palabras. Ejemplo:
                    </p>
                    <ul class="list-disc list-inside text-sm md:text-base ml-4">
                        <li>Ir recto 5 cuadros.</li>
                        <li>Girar 90¬∞ a la derecha.</li>
                        <li>Ir recto 3 cuadros.</li>
                        <li>Girar 45¬∞ a la izquierda.</li>
                        <li>Continuar hasta el Punto B.</li>
                    </ul>
                    <p class="text-sm md:text-base">
                        4Ô∏è‚É£ Guarda el archivo en la carpeta de la <strong>Misi√≥n 2</strong> en el Drive del curso.
                    </p>
                </div>
            </section>

            <!-- Hojas de construcci√≥n mejoradas con efectos hover -->
            <section id="sheet-3" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 3 ¬∑ Construcci√≥n (Pasos 1-3)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Inicia el m√≥dulo que unir√° a los dos RoverBots.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/1.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 1" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/2.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 2" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/3.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 3" onerror="this.style.display='none';">
                </div>
            </section>

            <section id="sheet-4" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 4 ¬∑ Construcci√≥n (Pasos 4-6)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Refuerza la base para que sea estable.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/4.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 4" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/5.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 5" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/6.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 6" onerror="this.style.display='none';">
                </div>
            </section>

            <section id="sheet-5" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 5 ¬∑ Construcci√≥n (Pasos 7-9)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Ajusta el soporte de la carga compartida.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/7.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 7" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/8.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 8" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/9.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 9" onerror="this.style.display='none';">
                </div>
            </section>

            <section id="sheet-6" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 6 ¬∑ Construcci√≥n (Pasos 10-12)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Conecta ambos RoverBots con el m√≥dulo central.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/10.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 10" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/11.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 11" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/12.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 12" onerror="this.style.display='none';">
                </div>
            </section>

            <section id="sheet-7" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 7 ¬∑ Construcci√≥n (Pasos 13-15)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Verifica que la estructura quede firme y alineada.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <img src="Colaboraci√≥n/13.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 13" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/14.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 14" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/15.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 15" onerror="this.style.display='none';">
                </div>
            </section>

            <section id="sheet-8" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 shadow-2xl flex-col justify-center space-y-3 overflow-y-auto">
                <h2 class="sheet-title text-2xl font-bold text-yellow-300 text-center">
                    Hoja 8 ¬∑ Construcci√≥n (Pasos 16-17)
                </h2>
                <p class="text-sm text-center text-white/90">
                    Revisa detalles finales. Tu m√≥dulo de colaboraci√≥n est√° listo para las pruebas.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <img src="Colaboraci√≥n/16.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 16" onerror="this.style.display='none';">
                    <img src="Colaboraci√≥n/17.jpg" class="w-full rounded-2xl border-2 border-white/40 hover-lift" alt="Paso 17" onerror="this.style.display='none';">
                </div>
                <p class="text-[10px] md:text-xs text-white/70">
                    Imagen ¬©2015 The LEGO Group. Usada con fines educativos y sin √°nimo de lucro.
                    Fuente: Instrucciones de construcci√≥n del set LEGO¬Æ Education WeDo 2.0 (45300).
                </p>
            </section>

            <!-- Hoja 9 con tabla mejorada -->
            <section id="sheet-9" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 md:p-6 shadow-2xl flex-col justify-center space-y-4 overflow-y-auto">
                <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center">
                    Hoja 9 ¬∑ Programa, prueba y calcula
                </h2>
                <p class="text-sm md:text-base text-white/90 text-center px-2">
                    Usa tu pseudoc√≥digo para programar ambos RoverBots. Haz al menos <strong>3 ensayos</strong> con la ruta,
                    esquivando los cr√°teres y llegando juntos al Punto B.
                </p>
                <p class="text-xs md:text-sm text-purple-200 text-center">
                    Copia esta tabla en tu cuaderno o en Word/Excel. Compl√©tala y s√∫bela al Drive como evidencia.
                </p>

                <div class="overflow-x-auto">
                    <table class="min-w-full text-[10px] md:text-xs text-center border-2 border-white/30 rounded-2xl overflow-hidden">
                        <thead class="bg-gradient-to-r from-purple-600 to-purple-500 text-white">
                            <tr>
                                <th class="px-2 py-2 border border-white/20">Ensayo</th>
                                <th class="px-2 py-2 border border-white/20">Distancia total (cm)</th>
                                <th class="px-2 py-2 border border-white/20">Potencia A (%)</th>
                                <th class="px-2 py-2 border border-white/20">Potencia B (%)</th>
                                <th class="px-2 py-2 border border-white/20">Tiempo (s)</th>
                                <th class="px-2 py-2 border border-white/20">√Ångulos usados</th>
                                <th class="px-2 py-2 border border-white/20">¬øLlegan juntos?</th>
                            </tr>
                        </thead>
                        <tbody class="glass-card text-white/90">
                            <tr class="table-row">
                                <td class="border border-white/10 py-2">1</td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                            </tr>
                            <tr class="table-row">
                                <td class="border border-white/10 py-2">2</td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                            </tr>
                            <tr class="table-row">
                                <td class="border border-white/10 py-2">3</td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                                <td class="border border-white/10"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="text-xs md:text-sm text-purple-200 text-center">
                    Incluye una explicaci√≥n: ¬øqu√© cambio matem√°tico ayud√≥ a que los RoverBots llegaran coordinados?
                </p>
            </section>

            <!-- Hoja 10 con botones mejorados -->
            <section id="sheet-10" class="sheet w-full max-w-5xl h-full glass-card rounded-3xl p-5 md:p-6 shadow-2xl flex-col justify-center space-y-4 overflow-y-auto">
                <h2 class="sheet-title text-2xl md:text-3xl font-bold text-yellow-300 text-center">
                    Hoja 10 ¬∑ Reflexiona y sube tus evidencias
                </h2>
                <p class="text-sm md:text-base text-white/90 text-center">
                    Responde estas preguntas en tu cuaderno o en un archivo Word (Misi√≥n 2 - Reflexi√≥n) y s√∫belo al Drive.
                </p>

                <ul class="list-decimal list-inside text-sm md:text-base text-white/90 space-y-1 px-6">
                    <li>¬øPor qu√© fue importante coordinar a los dos RoverBots?</li>
                    <li>¬øC√≥mo usaron distancias, tiempos y √°ngulos para mejorar el recorrido?</li>
                    <li>Describe un ejemplo real de buena colaboraci√≥n en tu equipo.</li>
                </ul>

                <div class="space-y-1 text-xs md:text-sm text-purple-200 px-4">
                    <p class="font-semibold">Evidencias para la carpeta de la Misi√≥n 2 en Drive:</p>
                    <ul class="list-disc list-inside text-white/90 space-y-1">
                        <li>Archivo Word con el pseudoc√≥digo.</li>
                        <li>Tabla de ensayos (cuaderno escaneado o archivo digital).</li>
                        <li>Respuestas de reflexi√≥n.</li>
                        <li>Fotos del escenario, los RoverBots conectados y la programaci√≥n.</li>
                    </ul>
                </div>

                <div class="mt-4 flex flex-wrap justify-center gap-3">
                    <button id="complete-btn"
                            onclick="completeMission()"
                            class="px-6 py-3 bg-gradient-to-r from-green-500 to-green-700 text-white font-bold text-sm md:text-base rounded-full shadow-lg btn-3d">
                        Marcar Misi√≥n 2 como completada
                    </button>
                    <a href="index.html"
                       id="completed-btn"
                       class="hidden px-6 py-3 bg-white text-green-600 font-bold text-sm md:text-base rounded-full shadow-lg btn-3d">
                        Volver a Misiones
                    </a>
                </div>
            </section>
        </div>

        <!-- Navegaci√≥n mejorada con efectos -->
        <div class="relative z-20 flex items-center justify-between mt-3">
            <button id="prev-btn"
                    onclick="prevSheet()"
                    class="px-5 py-2.5 glass-card text-white text-sm md:text-base rounded-full shadow-lg btn-3d disabled:opacity-30 disabled:hover:scale-100">
                ‚Üê Hoja anterior
            </button>
            <button id="next-btn"
                    onclick="nextSheet()"
                    class="px-5 py-2.5 bg-gradient-to-r from-purple-600 to-purple-500 text-white text-sm md:text-base font-semibold rounded-full shadow-lg btn-3d disabled:opacity-30 disabled:hover:scale-100">
                Siguiente hoja ‚Üí
            </button>
        </div>
    </main>

    <script>
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        function createShootingStar() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) return;
            
            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.left = Math.random() * 100 + '%';
            shootingStar.style.top = Math.random() * 50 + '%';
            starsContainer.appendChild(shootingStar);
            
            setTimeout(() => shootingStar.remove(), 1000);
        }

        function getCurrentPlayer() {
            return localStorage.getItem('zython-current-player');
        }

        function loadPlayerProgress(playerName) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                return players[playerName] || {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            } catch (error) {
                console.error('Error loading progress:', error);
                return {
                    completedMissions: [],
                    completed: 0,
                    currentMission: 1,
                    available: 1,
                    badges: 0
                };
            }
        }

        function savePlayerProgress(playerName, progress) {
            try {
                const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
                players[playerName] = progress;
                localStorage.setItem('zython-players', JSON.stringify(players));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        let currentSheet = 1;
        const totalSheets = 10;

        function showSheet(n) {
            if (n < 1 || n > totalSheets) return;
            currentSheet = n;

            for (let i = 1; i <= totalSheets; i++) {
                const sheet = document.getElementById(`sheet-${i}`);
                if (sheet) {
                    sheet.classList.toggle('active', i === currentSheet);
                }
            }

            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const sheetIndicator = document.getElementById('sheet-indicator');
            const sheetTotal = document.getElementById('sheet-total');

            if (sheetIndicator) sheetIndicator.textContent = currentSheet;
            if (sheetTotal) sheetTotal.textContent = totalSheets;

            if (prevBtn) prevBtn.disabled = currentSheet === 1;
            if (nextBtn) {
                nextBtn.disabled = currentSheet === totalSheets;
                nextBtn.textContent = currentSheet === totalSheets ? '√öltima hoja' : 'Siguiente hoja ‚Üí';
            }
        }

        function nextSheet() {
            if (currentSheet < totalSheets) showSheet(currentSheet + 1);
        }

        function prevSheet() {
            if (currentSheet > 1) showSheet(currentSheet - 1);
        }

        function checkCompletion() {
            const currentPlayer = getCurrentPlayer();
            if (currentPlayer) {
                const progress = loadPlayerProgress(currentPlayer);
                if (progress.completedMissions.includes(2)) {
                    const badge = document.getElementById('completion-badge');
                    const completeBtn = document.getElementById('complete-btn');
                    const completedBtn = document.getElementById('completed-btn');
                    if (badge) badge.classList.remove('hidden');
                    if (completeBtn) completeBtn.classList.add('hidden');
                    if (completedBtn) completedBtn.classList.remove('hidden');
                }
            }
        }

        function completeMission() {
            const currentPlayer = getCurrentPlayer();
            if (!currentPlayer) {
                console.error('No current player for mission completion');
                alert('Error: No se encontr√≥ informaci√≥n del jugador. Por favor, regresa al men√∫ principal.');
                return;
            }

            const progress = loadPlayerProgress(currentPlayer);

            if (!progress.completedMissions.includes(2)) {
                progress.completedMissions.push(2);
                progress.completed = progress.completedMissions.length;
                progress.badges = progress.completedMissions.length;

                progress.currentMission = Math.max(progress.currentMission, 3);
                progress.available = Math.max(progress.available, 3);

                savePlayerProgress(currentPlayer, progress);

                const badge = document.getElementById('completion-badge');
                const completeBtn = document.getElementById('complete-btn');
                const completedBtn = document.getElementById('completed-btn');
                if (badge) badge.classList.remove('hidden');
                if (completeBtn) completeBtn.classList.add('hidden');
                if (completedBtn) completedBtn.classList.remove('hidden');

                alert('¬°Felicitaciones! Has obtenido la Insignia "Colaboraci√≥n en Sensorium". La Misi√≥n 3 ahora est√° disponible.');
            } else {
                alert('Esta misi√≥n ya ha sido completada anteriormente.');
            }
        }

        function volverAMisiones() {
            window.location.href = 'index.html';
        }

        function initialize() {
            createStars();
            showSheet(1);
            checkCompletion();
            
            setInterval(createShootingStar, 5000);
        }

        let audioContext;
        let audioEnabled = true;
        let backgroundMusicInterval;
        
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }
        
        function playTone(frequency, duration, type = 'square') {
            if (!audioEnabled || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }
        
        function playBackgroundMusic() {
            if (!audioEnabled) return;
            
            const melody = [
                {freq: 523.25, dur: 0.2},
                {freq: 587.33, dur: 0.2},
                {freq: 659.25, dur: 0.2},
                {freq: 698.46, dur: 0.3},
                {freq: 783.99, dur: 0.2},
                {freq: 698.46, dur: 0.2},
                {freq: 659.25, dur: 0.4},
            ];
            
            let currentTime = 0;
            melody.forEach(note => {
                setTimeout(() => {
                    if (audioEnabled) playTone(note.freq, note.dur, 'sine');
                }, currentTime * 1000);
                currentTime += note.dur + 0.1;
            });
        }
        
        function startBackgroundMusic() {
            if (backgroundMusicInterval) clearInterval(backgroundMusicInterval);
            playBackgroundMusic();
            backgroundMusicInterval = setInterval(playBackgroundMusic, 3000);
        }
        
        function stopBackgroundMusic() {
            if (backgroundMusicInterval) {
                clearInterval(backgroundMusicInterval);
                backgroundMusicInterval = null;
            }
        }
        
        function toggleAudio() {
            audioEnabled = !audioEnabled;
            const button = document.getElementById('audio-toggle');
            
            if (audioEnabled) {
                button.textContent = 'üîä Audio ON';
                button.classList.add('active');
                initAudio();
                startBackgroundMusic();
            } else {
                button.textContent = 'üîá Audio OFF';
                button.classList.remove('active');
                stopBackgroundMusic();
            }
        }
        
        document.addEventListener('click', function initOnFirstClick() {
            initAudio();
            startBackgroundMusic();
            document.removeEventListener('click', initOnFirstClick);
        }, { once: true });

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
