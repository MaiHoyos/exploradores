<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploraci√≥n de Zython - Misiones Espaciales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Agregando fuente personalizada m√°s moderna y legible para ni√±os */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap');
        
        * {
            font-family: 'Fredoka', sans-serif;
        }
        
        /* Animaciones mejoradas con efectos m√°s fluidos y profesionales */
        @keyframes planetBounce {
            0%, 100% { 
                transform: translateY(0px) scale(1) rotate(0deg); 
            }
            25% { 
                transform: translateY(-8px) scale(1.02) rotate(1deg); 
            }
            50% { 
                transform: translateY(-15px) scale(1.05) rotate(-1deg); 
            }
            75% { 
                transform: translateY(-8px) scale(1.02) rotate(1deg); 
            }
        }
        
        .animate-planet-bounce {
            animation: planetBounce 5s ease-in-out infinite;
        }
        
        /* Efecto de brillo pulsante para las cards */
        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(99, 102, 241, 0.4),
                           0 0 40px rgba(99, 102, 241, 0.2),
                           0 10px 50px rgba(0, 0, 0, 0.5);
            }
            50% { 
                box-shadow: 0 0 30px rgba(99, 102, 241, 0.6),
                           0 0 60px rgba(99, 102, 241, 0.4),
                           0 15px 60px rgba(0, 0, 0, 0.6);
            }
        }
        
        /* Sistema de estrellas mejorado con m√∫ltiples capas y colores */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        /* Efecto de centelleo mejorado con variaciones */
        @keyframes twinkle {
            0%, 100% { 
                opacity: 0.2; 
                transform: scale(1);
            }
            50% { 
                opacity: 1; 
                transform: scale(1.2);
            }
        }
        
        /* Animaci√≥n de estrella fugaz */
        @keyframes shootingStar {
            0% {
                transform: translateX(0) translateY(0) rotate(-45deg);
                opacity: 1;
            }
            100% {
                transform: translateX(-500px) translateY(500px) rotate(-45deg);
                opacity: 0;
            }
        }
        
        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.8);
        }
        
        .shooting-star::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 1px;
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 100%);
        }
        
        /* Efecto de gradiente animado en el fondo */
        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        .animated-gradient {
            background: linear-gradient(
                135deg,
                #1e1b4b 0%, 
                #312e81 15%,
                #1e3a8a 30%,
                #1e40af 45%,
                #1e1b4b 60%,
                #581c87 75%,
                #6b21a8 90%,
                #000000 100%
            );
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        /* Efecto hover mejorado para planetas con transformaci√≥n 3D */
        .planet-card {
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-style: preserve-3d;
        }
        
        .planet-card:hover {
            transform: translateY(-20px) scale(1.1) rotateX(5deg);
            animation: glow 2s ease-in-out infinite;
        }
        
        .planet-image {
            transition: all 0.4s ease;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }
        
        .planet-card:hover .planet-image {
            border-color: rgba(255, 255, 255, 0.8);
            transform: rotate(2deg) scale(1.05);
        }
        
        /* Animaci√≥n de entrada escalonada para los planetas */
        @keyframes fadeInScale {
            from { 
                opacity: 0; 
                transform: scale(0.5) translateY(50px);
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0);
            }
        }
        
        .animate-fadeIn {
            animation: fadeInScale 0.6s ease-out forwards;
        }
        
        .mission-1 { animation-delay: 0.1s; }
        .mission-2 { animation-delay: 0.2s; }
        .mission-3 { animation-delay: 0.3s; }
        .mission-4 { animation-delay: 0.4s; }
        
        /* Badge de n√∫mero de misi√≥n con efecto de pulso */
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);
            }
        }
        
        .mission-badge {
            animation: pulse 2s ease-in-out infinite;
        }
        
        /* Header con efecto de vidrio esmerilado mejorado */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3),
                       inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        /* Texto con efecto ne√≥n mejorado */
        .neon-text {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            text-shadow: 
                0 0 10px rgba(147, 197, 253, 0.8),
                0 0 20px rgba(147, 197, 253, 0.6),
                0 0 30px rgba(147, 197, 253, 0.4),
                0 0 40px rgba(59, 130, 246, 0.3);
            animation: neonFlicker 3s ease-in-out infinite;
        }
        
        @keyframes neonFlicker {
            0%, 100% { opacity: 1; }
            45%, 55% { opacity: 0.9; }
            50% { opacity: 0.95; }
        }
        
        /* Info card con mejor contraste y efectos */
        .info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4),
                       0 0 20px rgba(99, 102, 241, 0.3);
            transition: all 0.3s ease;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5),
                       0 0 30px rgba(99, 102, 241, 0.5);
        }
        
        /* Planet info card mejorada */
        .planet-info {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.8));
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6),
                       inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        /* Bot√≥n de reset mejorado */
        .reset-button {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
            transition: all 0.3s ease;
        }
        
        .reset-button:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            box-shadow: 0 6px 25px rgba(239, 68, 68, 0.6);
            transform: translateY(-2px) scale(1.05);
        }
        
        /* Robot con animaci√≥n de flotaci√≥n */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }
        
        .floating-robot {
            animation: float 4s ease-in-out infinite;
        }

        
        @media (max-width: 768px) {
            .mobile-planet-small { width: 100px !important; height: 100px !important; }
            .mobile-planet-medium { width: 120px !important; height: 120px !important; }
            .mobile-planet-large { width: 140px !important; height: 140px !important; }
            .mobile-text-small { font-size: 0.75rem !important; }
            .mobile-text-xs { font-size: 0.625rem !important; }
        }

        @media (max-width: 640px) {
            /* Header m√°s compacto */
            header {
                padding: 0.75rem !important;
                margin: 0.5rem !important;
            }
            
            /* T√≠tulo principal responsive */
            .neon-text {
                font-size: 1.25rem !important;
                line-height: 1.2;
            }
            
            .text-yellow-300.drop-shadow-lg {
                font-size: 1rem !important;
            }
            
            /* Card de estad√≠sticas m√°s peque√±a y accesible */
            .info-card {
                min-width: 150px !important;
                padding: 0.5rem !important;
                top: 0.5rem !important;
                right: 0.5rem !important;
            }
            
            .info-card .grid {
                gap: 0.5rem !important;
            }
            
            .info-card div:first-child {
                font-size: 1.25rem !important;
            }
            
            .info-card .text-xs {
                font-size: 0.625rem !important;
            }
            
            /* Planetas optimizados para m√≥vil */
            .planet-card {
                width: 110px !important;
            }
            
            .mobile-planet-large {
                width: 110px !important;
                height: 110px !important;
            }
            
            .mobile-planet-medium {
                width: 95px !important;
                height: 95px !important;
            }
            
            .mobile-planet-small {
                width: 80px !important;
                height: 80px !important;
            }
            
            /* Posiciones ajustadas para 360px de ancho */
            [data-mission-id="1"] {
                top: 8% !important;
                left: 5% !important;
            }
            
            [data-mission-id="2"] {
                top: 8% !important;
                right: 5% !important;
            }
            
            [data-mission-id="3"] {
                top: 42% !important;
                left: 8% !important;
            }
            
            [data-mission-id="4"] {
                top: 42% !important;
                right: 8% !important;
            }
            
            /* Planet info m√°s compacto */
            .planet-info {
                min-width: 100px !important;
                padding: 0.5rem !important;
            }
            
            .mobile-text-small {
                font-size: 0.7rem !important;
            }
            
            .mobile-text-xs {
                font-size: 0.6rem !important;
            }
            
            /* Badges m√°s peque√±os */
            .mission-badge {
                width: 2rem !important;
                height: 2rem !important;
                font-size: 0.875rem !important;
            }
            
            /* Botones m√°s accesibles */
            .reset-button, .sound-toggle {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.75rem !important;
                bottom: 0.75rem !important;
            }
            
            .reset-button {
                left: 0.5rem !important;
            }
            
            .sound-toggle {
                left: 5.5rem !important;
                right: auto !important;
            }
        }

        .mission-link {
            display: block;
            text-decoration: none;
            color: inherit;
        }

        /* Estado bloqueado mejorado con efecto visual claro */
        .locked {
            filter: grayscale(100%) brightness(0.6);
            pointer-events: none;
            cursor: not-allowed;
            opacity: 0.4;
            transition: all 0.3s ease-in-out;
            position: relative;
        }
        
        .locked::after {
            content: 'üîí';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            opacity: 0.8;
            pointer-events: none;
        }

        .locked:hover {
            transform: none !important;
        }

        /* Estilos para el bot√≥n de control de sonido */
        .sound-toggle {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
            transition: all 0.3s ease;
        }
        
        .sound-toggle:hover {
            background: linear-gradient(135deg, #7c3aed, #5b21b6);
            box-shadow: 0 6px 25px rgba(139, 92, 246, 0.6);
            transform: translateY(-2px) scale(1.05);
        }

        .sound-toggle.active {
            background: linear-gradient(135deg, #10b981, #059669);
        }
    </style>
</head>
<body class="min-h-screen animated-gradient text-white overflow-x-hidden relative">
    <!-- Capa de estrellas con z-index mejorado -->
    <div class="stars" id="stars"></div>
    
    <div id="game-content" class="relative z-10 min-h-screen">
        <!-- Header mejorado con efecto de vidrio esmerilado -->
        <header class="relative z-10 p-3 md:p-6 m-2 md:m-4">
            <div class="glass-card rounded-2xl md:rounded-3xl p-4 md:p-6">
                <div class="flex items-center justify-center md:justify-between flex-col md:flex-row gap-4">
                    <div class="flex items-center gap-4">
                        <div class="text-4xl md:text-5xl animate-planet-bounce">üöÄ</div>
                        <div class="text-center md:text-left">
                            <div class="neon-text text-2xl md:text-3xl tracking-wider">EXPLORACI√ìN</div>
                            <div class="text-lg md:text-2xl font-bold text-yellow-300 drop-shadow-lg">de Zython</div>
                            <div class="text-xs md:text-sm text-white/90 drop-shadow mt-2 bg-black/40 px-3 py-1 rounded-full inline-block">
                                Explorador: <span id="player-name-display" class="text-yellow-300 font-bold">Explorador 1</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Card de estad√≠sticas mejorada con gradientes y sombras -->
        <div class="fixed top-2 right-2 md:top-4 md:right-4 z-20 info-card rounded-xl md:rounded-2xl p-3 md:p-5 min-w-[180px] md:min-w-[220px]">
            <div class="grid grid-cols-3 gap-3 md:gap-4 text-center">
                <div class="transform transition-all hover:scale-110">
                    <div class="text-2xl md:text-3xl font-bold text-yellow-600 drop-shadow-lg">4</div>
                    <div class="text-[10px] md:text-xs text-gray-800 font-semibold">üéØ Disponibles</div>
                </div>
                <div class="transform transition-all hover:scale-110">
                    <div class="text-2xl md:text-3xl font-bold text-green-600 drop-shadow-lg" id="completed-count">0</div>
                    <div class="text-[10px] md:text-xs text-gray-800 font-semibold">‚≠ê Completadas</div>
                </div>
                <div class="transform transition-all hover:scale-110">
                    <div class="text-2xl md:text-3xl font-bold text-purple-600 drop-shadow-lg" id="current-mission">1</div>
                    <div class="text-[10px] md:text-xs text-gray-800 font-semibold">üöÄ Misi√≥n Actual</div>
                </div>
            </div>
        </div>

        <!-- Contenedor de planetas con posicionamiento relativo para que quede dentro del viewport -->
        <div class="relative w-full px-4 md:px-10 pb-32 pt-4" style="min-height: calc(100vh - 180px);">
            <!-- Planeta 1 - Llanura de Vectonia -->
            <div class="absolute top-[5%] left-[8%] md:top-[8%] md:left-[12%] w-[140px] md:w-[220px] z-10 animate-fadeIn mission-1" data-mission-id="1">
                <a href="mision1.html" class="mission-link">
                    <div class="flex flex-col items-center cursor-pointer planet-card">
                        <div class="mobile-planet-large w-[140px] h-[140px] md:w-[220px] md:h-[220px] mb-2 md:mb-4 relative rounded-3xl overflow-hidden planet-image shadow-2xl">
                            <img src="mision1.png" alt="Llanura de Vectonia" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-full flex items-center justify-center text-5xl md:text-7xl bg-gradient-to-br from-pink-500 via-teal-400 to-green-500&quot;>üèîÔ∏è</div>'">
                        </div>
                        <div class="text-center planet-info px-3 py-3 md:px-5 md:py-4 rounded-xl md:rounded-2xl min-w-[130px] md:min-w-[200px]">
                            <div class="mobile-text-small text-sm md:text-lg font-bold mb-1 text-white drop-shadow-lg">Llanura de Vectonia</div>
                            <div class="mobile-text-xs text-xs md:text-sm text-cyan-300 drop-shadow font-medium">Calibra tu RoverBot</div>
                        </div>
                    </div>
                </a>
                <div class="mission-badge absolute -top-1 -right-1 md:-top-2 md:-right-2 w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center text-base md:text-xl font-bold border-3 border-white shadow-xl bg-gradient-to-br from-orange-400 to-orange-600">1</div>
            </div>

            <!-- Planeta 2 - Paso de Zycurva -->
            <div class="absolute top-[5%] right-[35%] md:top-[12%] md:right-[45%] w-[120px] md:w-[160px] z-10 animate-fadeIn mission-2 locked" data-mission-id="2">
                <a href="mision2.html" class="mission-link">
                    <div class="flex flex-col items-center cursor-pointer planet-card">
                        <div class="mobile-planet-medium w-[120px] h-[120px] md:w-[160px] md:h-[160px] mb-2 md:mb-4 relative rounded-3xl overflow-hidden planet-image shadow-2xl">
                            <img src="mision2.png" alt="Paso de Zycurva" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-full flex items-center justify-center text-4xl md:text-6xl bg-gradient-to-br from-blue-500 via-purple-400 to-pink-500&quot;>üåÄ</div>'">
                        </div>
                        <div class="text-center planet-info px-3 py-2 md:px-4 md:py-3 rounded-xl md:rounded-2xl min-w-[110px] md:min-w-[150px]">
                            <div class="mobile-text-small text-xs md:text-base font-bold mb-1 text-white drop-shadow-lg">Paso de Zycurva</div>
                            <div class="mobile-text-xs text-[10px] md:text-xs text-cyan-300 drop-shadow font-medium">¬°Activa la conexi√≥n!</div>
                        </div>
                    </div>
                </a>
                <div class="mission-badge absolute -top-1 -right-1 md:-top-2 md:-right-2 w-9 h-9 md:w-12 md:h-12 rounded-full flex items-center justify-center text-base md:text-xl font-bold border-3 border-white shadow-xl bg-gradient-to-br from-blue-400 to-blue-600">2</div>
            </div>

            <!-- Planeta 3 - Cr√°ter del Sensorium -->
            <div class="absolute top-[45%] left-[15%] md:top-[50%] md:left-[28%] w-[100px] md:w-[140px] z-10 animate-fadeIn mission-3 locked" data-mission-id="3">
                <a href="mision3.html" class="mission-link">
                    <div class="flex flex-col items-center cursor-pointer planet-card">
                        <div class="mobile-planet-small w-[100px] h-[100px] md:w-[140px] md:h-[140px] mb-2 md:mb-4 relative rounded-3xl overflow-hidden planet-image shadow-2xl">
                            <img src="mision3.png" alt="Cr√°ter del Sensorium" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-full flex items-center justify-center text-4xl md:text-6xl bg-gradient-to-br from-purple-500 via-pink-400 to-red-500&quot;>üï≥Ô∏è</div>'">
                        </div>
                        <div class="text-center planet-info px-2 py-2 md:px-4 md:py-3 rounded-xl md:rounded-2xl min-w-[90px] md:min-w-[130px]">
                            <div class="mobile-text-small text-xs md:text-sm font-bold mb-1 text-white drop-shadow-lg">Cr√°ter del Sensorium</div>
                            <div class="mobile-text-xs text-[10px] md:text-xs text-cyan-300 drop-shadow font-medium">¬°Detente a tiempo!</div>
                        </div>
                    </div>
                </a>
                <div class="mission-badge absolute -top-1 -right-1 md:-top-2 md:-right-2 w-8 h-8 md:w-11 md:h-11 rounded-full flex items-center justify-center text-sm md:text-lg font-bold border-3 border-white shadow-xl bg-gradient-to-br from-purple-400 to-purple-600">3</div>
            </div>

            <!-- Planeta 4 - Estaci√≥n de Transferencia -->
            <div class="absolute top-[45%] right-[8%] md:top-[48%] md:right-[20%] w-[120px] md:w-[190px] z-10 animate-fadeIn mission-4 locked" data-mission-id="4">
                <a href="mision4.html" class="mission-link">
                    <div class="flex flex-col items-center cursor-pointer planet-card">
                        <div class="mobile-planet-medium w-[120px] h-[120px] md:w-[190px] md:h-[190px] mb-2 md:mb-4 relative rounded-3xl overflow-hidden planet-image shadow-2xl">
                            <img src="mision4.png" alt="Estaci√≥n de Transferencia" class="w-full h-full object-cover" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-full flex items-center justify-center text-5xl md:text-7xl bg-gradient-to-br from-green-500 via-emerald-400 to-teal-500&quot;>üöõ</div>'">
                        </div>
                        <div class="text-center planet-info px-3 py-2 md:px-4 md:py-3 rounded-xl md:rounded-2xl min-w-[110px] md:min-w-[180px]">
                            <div class="mobile-text-small text-sm md:text-base font-bold mb-1 text-white drop-shadow-lg">Estaci√≥n de Transferencia</div>
                            <div class="mobile-text-xs text-[10px] md:text-xs text-cyan-300 drop-shadow font-medium">Transporte en equipo</div>
                        </div>
                    </div>
                </a>
                <div class="mission-badge absolute -top-1 -right-1 md:-top-2 md:-right-2 w-9 h-9 md:w-12 md:h-12 rounded-full flex items-center justify-center text-base md:text-xl font-bold border-3 border-white shadow-xl bg-gradient-to-br from-green-400 to-green-600">4</div>
            </div>

            <!-- Robot con animaci√≥n de flotaci√≥n -->
            <div class="hidden md:block absolute bottom-0 right-4 w-[300px] h-[300px] lg:w-[400px] lg:h-[400px] z-5 floating-robot opacity-70">
                <img src="robot.png" alt="Robot Compa√±ero" class="w-full h-full object-contain drop-shadow-2xl" onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;w-full h-full flex items-center justify-center text-9xl&quot;>ü§ñ</div>'">
            </div>
        </div>
    </div>
    
    <!-- Bot√≥n de reset mejorado con clases personalizadas -->
    <button id="reset-button" class="reset-button fixed bottom-4 left-4 z-30 px-5 py-3 text-white rounded-full font-bold text-sm md:text-base">
        üîÑ Reiniciar
    </button>

    <!-- Bot√≥n para activar/desactivar sonido -->
    <button id="sound-toggle" class="sound-toggle fixed bottom-4 left-24 md:left-32 z-30 px-5 py-3 text-white rounded-full font-bold text-sm md:text-base">
        üîá Sonido
    </button>

    <script>
        class RetroAudioSystem {
            constructor() {
                this.audioContext = null;
                this.isEnabled = true;
                this.isMusicPlaying = false;
                this.musicInterval = null;
            }

            init() {
                if (!this.audioContext) {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                this.isEnabled = true;
                return this.audioContext;
            }

            playTone(frequency, duration, volume = 0.1, type = 'square') {
                if (!this.isEnabled || !this.audioContext) return;

                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.type = type;
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                
                gainNode.gain.setValueAtTime(volume, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            }

            // Sonido de hover sobre planetas
            playHoverSound() {
                this.playTone(800, 0.1, 0.08);
            }

            // Sonido de clic en planeta
            playClickSound() {
                this.playTone(1200, 0.05, 0.12);
                setTimeout(() => this.playTone(1500, 0.08, 0.1), 50);
            }

            // Sonido de estrella fugaz
            playShootingStarSound() {
                if (!this.isEnabled || !this.audioContext) return;
                
                const now = this.audioContext.currentTime;
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(1000, now);
                oscillator.frequency.exponentialRampToValueAtTime(200, now + 0.5);
                
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.5);
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.start(now);
                oscillator.stop(now + 0.5);
            }

            // M√∫sica de fondo estilo espacial 8-bit
            startBackgroundMusic() {
                if (!this.isEnabled || this.isMusicPlaying) return;
                
                this.isMusicPlaying = true;
                const melodyNotes = [
                    { freq: 523, dur: 0.3 },  // C5
                    { freq: 587, dur: 0.3 },  // D5
                    { freq: 659, dur: 0.3 },  // E5
                    { freq: 784, dur: 0.3 },  // G5
                    { freq: 659, dur: 0.3 },  // E5
                    { freq: 587, dur: 0.3 },  // D5
                    { freq: 523, dur: 0.6 },  // C5
                ];
                
                let noteIndex = 0;
                
                const playNextNote = () => {
                    if (!this.isMusicPlaying) return;
                    
                    const note = melodyNotes[noteIndex];
                    this.playTone(note.freq, note.dur, 0.03, 'triangle');
                    
                    noteIndex = (noteIndex + 1) % melodyNotes.length;
                    
                    this.musicInterval = setTimeout(playNextNote, note.dur * 1000);
                };
                
                playNextNote();
            }

            stopBackgroundMusic() {
                this.isMusicPlaying = false;
                if (this.musicInterval) {
                    clearTimeout(this.musicInterval);
                    this.musicInterval = null;
                }
            }

            toggle() {
                this.isEnabled = !this.isEnabled;
                
                if (this.isEnabled) {
                    this.init();
                    this.startBackgroundMusic();
                } else {
                    this.stopBackgroundMusic();
                }
                
                return this.isEnabled;
            }
        }

        // Crear instancia del sistema de audio
        const audioSystem = new RetroAudioSystem();
        
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const colors = ['#ffffff', '#ffe9c4', '#d4f1f9', '#ffd9e8'];
            
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.animationDuration = (Math.random() * 2 + 2) + 's';
                star.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                starsContainer.appendChild(star);
            }
        }
        
        function createShootingStar() {
            const starsContainer = document.getElementById('stars');
            const shootingStar = document.createElement('div');
            shootingStar.className = 'shooting-star';
            shootingStar.style.left = Math.random() * 100 + '%';
            shootingStar.style.top = Math.random() * 50 + '%';
            shootingStar.style.animation = 'shootingStar 1s ease-out forwards';
            starsContainer.appendChild(shootingStar);
            
            audioSystem.playShootingStarSound();
            
            setTimeout(() => {
                shootingStar.remove();
            }, 1000);
        }
        
        function startShootingStars() {
            setInterval(() => {
                if (Math.random() > 0.7) {
                    createShootingStar();
                }
            }, 3000);
        }

        function resetGame() {
            if (confirm('¬øEst√°s seguro de que quieres reiniciar el progreso? Se perder√°n todas las misiones completadas.')) {
                localStorage.removeItem('zython-mission-1');
                localStorage.removeItem('zython-mission-2');
                localStorage.removeItem('zython-mission-3');
                localStorage.removeItem('zython-mission-4');
                localStorage.removeItem('mision1Completada');
                localStorage.removeItem('mision2Completada');
                localStorage.removeItem('mision3Completada');
                localStorage.removeItem('mision4Completada');
                localStorage.removeItem('mision1Data');
                localStorage.removeItem('mision2Data');
                localStorage.removeItem('mision3Data');
                localStorage.removeItem('mision4Data');
                localStorage.removeItem('zython-players');
                localStorage.setItem('zython-current-mission', '0');
                
                // Redirigir a mision0.html
                window.location.href = 'mision0.html';
            }
        }

        function setupGame(playerName) {
            // Obtener el progreso del jugador desde localStorage
            const players = JSON.parse(localStorage.getItem('zython-players') || '{}');
            const playerData = players[playerName] || {
                completedMissions: [],
                completed: 0,
                currentMission: 1
            };

            // Actualizar contador de misiones completadas
            const completedCount = playerData.completedMissions.length;
            document.getElementById('completed-count').textContent = completedCount;

            let currentMissionNumber = 1;
            if (completedCount > 0) {
                const maxCompletedMission = Math.max(...playerData.completedMissions);
                currentMissionNumber = Math.min(maxCompletedMission + 1, 4);
            }
            document.getElementById('current-mission').textContent = currentMissionNumber;

            // Desbloquear misiones completadas y la siguiente
            playerData.completedMissions.forEach(missionId => {
                const missionElement = document.querySelector(`[data-mission-id="${missionId}"]`);
                if (missionElement) {
                    missionElement.classList.remove('locked');
                    // Agregar indicador visual de completada
                    const badge = missionElement.querySelector('.mission-badge');
                    if (badge && !badge.textContent.includes('‚úì')) {
                        badge.innerHTML = `${missionId}<br><span style="font-size: 0.7em;">‚úì</span>`;
                        badge.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                    }
                }
            });

            const maxCompletedMission = playerData.completedMissions.length > 0 
                ? Math.max(...playerData.completedMissions) 
                : 0;
            const nextMissionId = maxCompletedMission + 1;
            
            if (nextMissionId <= 4) {
                const nextMissionElement = document.querySelector(`[data-mission-id="${nextMissionId}"]`);
                if (nextMissionElement) {
                    nextMissionElement.classList.remove('locked');
                }
            }

            console.log('[v0] Progreso cargado:', {
                player: playerName,
                completed: completedCount,
                currentMission: currentMissionNumber,
                completedMissions: playerData.completedMissions,
                nextToUnlock: nextMissionId
            });
        }

        function addSoundEffectsToPlanets() {
            const planetCards = document.querySelectorAll('.planet-card');
            
            planetCards.forEach(card => {
                // Sonido al pasar el mouse
                card.addEventListener('mouseenter', () => {
                    if (!card.closest('.locked')) {
                        audioSystem.playHoverSound();
                    }
                });
                
                // Sonido al hacer clic
                card.addEventListener('click', (e) => {
                    if (!card.closest('.locked')) {
                        audioSystem.playClickSound();
                    }
                });
            });
        }

        function initialize() {
            createStars();
            startShootingStars();
            const playerName = "Explorador 1";
            localStorage.setItem('zython-current-player', playerName);
            setupGame(playerName);
            
            audioSystem.init();
            
            document.body.addEventListener('click', function initAudio() {
                audioSystem.startBackgroundMusic();
                document.body.removeEventListener('click', initAudio);
            }, { once: true });
            
            document.getElementById('reset-button').addEventListener('click', resetGame);
            
            // Bot√≥n de control de sonido
            const soundToggle = document.getElementById('sound-toggle');
            soundToggle.textContent = 'üîä Sonido';
            soundToggle.classList.add('active');
            
            soundToggle.addEventListener('click', () => {
                const isEnabled = audioSystem.toggle();
                soundToggle.textContent = isEnabled ? 'üîä Sonido' : 'üîá Sonido';
                soundToggle.classList.toggle('active', isEnabled);
                
                // Reproducir sonido de confirmaci√≥n
                if (isEnabled) {
                    audioSystem.playClickSound();
                }
            });
            
            addSoundEffectsToPlanets();
        }

        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
